"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1293],{8503:(e,t,r)=>{r.d(t,{H5:()=>c,IY:()=>d,UU:()=>o,cI:()=>u,gP:()=>m,z:()=>i});var l=r(81242);r(93402);let a="/drivers",n=(e,t)=>{var r,l;return(null==e||null==(l=e.response)||null==(r=l.data)?void 0:r.message)||(null==e?void 0:e.message)||t};function s(e){let t=(0,l.I)(e);return Array.isArray(t)?t:t&&Array.isArray(t.content)?t.content:[]}async function o(e){try{let{data:t}=await l.A.get(a,{params:{page:0,size:1e3,...(null==e?void 0:e.trim())?{search:e.trim()}:{}}});return s(t)}catch(e){throw Error(n(e,"Failed to fetch drivers"))}}async function i(e){try{let{data:t}=await l.A.get("/drivers/deleted",{params:{page:0,size:1e3,...(null==e?void 0:e.trim())?{search:e.trim()}:{}}});return s(t)}catch(e){throw Error(n(e,"Failed to fetch deleted drivers"))}}async function c(e){try{let{data:t}=await l.A.get("".concat(a,"/").concat(e));return(0,l.I)(t)}catch(e){throw Error(n(e,"Driver not found"))}}async function d(e){try{let{data:t}=await l.A.post(a,e);return(0,l.I)(t)}catch(e){throw Error(n(e,"Failed to add driver"))}}async function u(e,t){try{let{data:r}=await l.A.put("".concat(a,"/").concat(e),t);return(0,l.I)(r)}catch(e){throw Error(n(e,"Failed to update driver"))}}async function m(e){try{await l.A.delete("".concat(a,"/").concat(e))}catch(e){throw Error(n(e,"Failed to delete driver"))}}},21293:(e,t,r)=>{r.r(t),r.d(t,{default:()=>M});var l=r(95155),a=r(12115),n=r(20063),s=r(12008),o=r(90368),i=r(27937),c=r(35626),d=r(6191),u=r(309),m=r(54485),x=r(11010),g=r(71360),p=r(8503),h=r(65229),b=r(22544),v=r(37621);let f=["ACTIVE","INACTIVE","SUSPENDED"];function y(e){var t,r,n,s,o,i,c;let d,{driver:u,onSubmit:m,onClose:x}=e,{register:g,handleSubmit:p,formState:{errors:y},reset:N,setValue:j,watch:w}=(0,b.mN)({defaultValues:{employeeId:null!=(t=null==u?void 0:u.employeeId)?t:"",name:null!=(r=null==u?void 0:u.name)?r:"",phone:null!=(n=null==u?void 0:u.phone)?n:"",email:null!=(s=null==u?void 0:u.email)?s:"",licenseNumber:null!=(o=null==u?void 0:u.licenseNumber)?o:"",licenseExpiryDate:(null==u?void 0:u.licenseExpiryDate)&&(d=u.licenseExpiryDate)?d.toString().slice(0,10):"",drivingExperience:null!=(i=null==u?void 0:u.drivingExperience)?i:void 0,status:null!=(c=null==u?void 0:u.status)?c:"ACTIVE"}}),E=async e=>{var t,r,l,a,n,s,o;let i=void 0===e.drivingExperience||null===e.drivingExperience||(null==(t=e.drivingExperience)?void 0:t.toString().trim())===""?void 0:Number(e.drivingExperience);await m({employeeId:null==(r=e.employeeId)?void 0:r.trim(),name:null==(l=e.name)?void 0:l.trim(),phone:null==(a=e.phone)?void 0:a.trim(),email:null==(n=e.email)?void 0:n.trim(),licenseNumber:null==(s=e.licenseNumber)?void 0:s.trim(),licenseExpiryDate:e.licenseExpiryDate||void 0,drivingExperience:i,status:null!=(o=e.status)?o:"ACTIVE"}),N(),x()},[A,D]=(0,a.useState)([]),[C,I]=(0,a.useState)(!1),[S,T]=(0,a.useState)(null),[k,P]=(0,a.useState)(null),[L,F]=(0,a.useState)(!1),R=(0,a.useRef)(null),M=g("name",{required:"Name is required"}),z=g("employeeId",{required:"Employee ID is required"}),U=w("name")||"",V=w("employeeId")||"",[B,Y]=(0,a.useState)(U||V||"");(0,a.useEffect)(()=>{(U||V)&&Y(U||V)},[U,V]),(0,a.useEffect)(()=>{let e=!1;return(async()=>{I(!0),T(null);try{let{data:t}=await v.A.get("/registrations");if(e)return;let r=Array.isArray(t)?t:[];D(r)}catch(l){var t,r;if(e)return;T((null==l||null==(r=l.response)||null==(t=r.data)?void 0:t.message)||(null==l?void 0:l.message)||"Unable to load employees")}finally{e||I(!1)}})(),()=>{e=!0}},[]),(0,a.useEffect)(()=>()=>{R.current&&clearTimeout(R.current)},[]);let _=(0,a.useMemo)(()=>{let e=A||[];return t=>{let r=(t||"").trim().toLowerCase();return r?e.filter(e=>[e.fullName,e.nameWithInitials,e.epfNo,e.department,null==e?void 0:e.mobileNo,null==e?void 0:e.email].some(e=>null==e?void 0:e.toLowerCase().includes(r))).slice(0,8):e.slice(0,8)}},[A]),q=(0,a.useMemo)(()=>L?_(B):[],[L,_,B]);return(0,l.jsx)("div",{className:"fixed inset-0 bg-black/40 flex items-center justify-center z-50 p-4",children:(0,l.jsxs)("div",{className:"bg-orange-50 rounded-xl shadow-xl w-full max-w-3xl overflow-hidden border border-orange-200",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between px-6 py-4 border-b border-orange-200 bg-orange-100",children:[(0,l.jsx)("h2",{className:"text-xl font-bold text-orange-900",children:u?"Edit Driver":"Add Driver"}),(0,l.jsx)("button",{type:"button",onClick:x,className:"p-2 rounded-lg hover:bg-orange-200 text-orange-700 transition-all","aria-label":"Close",title:"Close",children:(0,l.jsx)(h.A,{size:22})})]}),(0,l.jsxs)("form",{onSubmit:p(E),className:"px-6 py-5 bg-white",children:[(0,l.jsxs)("p",{className:"text-sm text-orange-700 mb-5",children:["Fields marked with ",(0,l.jsx)("span",{className:"text-red-600 font-semibold",children:"*"})," are required."]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-5",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-orange-800 mb-1",children:["Employee / Driver ",(0,l.jsx)("span",{className:"text-red-600",children:"*"})]}),C?(0,l.jsx)("span",{className:"text-[11px] text-gray-500",children:"Loading directory…"}):null]}),(0,l.jsx)("input",{autoComplete:"off",className:"w-full px-4 py-2.5 rounded-lg border focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all ".concat(y.name?"border-red-500":"border-orange-200"),...M,placeholder:"Search by name, EPF, department…",onFocus:()=>{R.current&&(clearTimeout(R.current),R.current=null),F(!0),Y(U)},onChange:e=>{M.onChange(e),R.current&&(clearTimeout(R.current),R.current=null),F(!0),Y(e.target.value),k&&(P(null),j("employeeId","",{shouldDirty:!0,shouldValidate:!0}))},onBlur:e=>{M.onBlur(e),R.current=setTimeout(()=>F(!1),120)}}),L?(0,l.jsx)("div",{className:"absolute z-20 w-full bg-white border border-orange-100 rounded-lg shadow-lg mt-1 max-h-60 overflow-y-auto",children:C?(0,l.jsx)("div",{className:"px-3 py-2 text-[12px] text-gray-500",children:"Loading employees…"}):q.length?q.map((e,t)=>(0,l.jsxs)("button",{type:"button",className:"w-full text-left px-3 py-2 hover:bg-orange-50",onMouseDown:t=>{t.preventDefault();let r=(e.fullName||e.nameWithInitials||e.epfNo||"").trim()||"Unnamed employee";j("name",r,{shouldDirty:!0,shouldValidate:!0}),j("employeeId",e.epfNo||"",{shouldDirty:!0,shouldValidate:!0}),j("phone",(null==e?void 0:e.mobileNo)||"",{shouldDirty:!0}),j("email",(null==e?void 0:e.email)||"",{shouldDirty:!0}),P(e),Y(r||e.epfNo||""),F(!1)},children:[(0,l.jsx)("div",{className:"text-[13px] font-medium text-orange-900",children:e.fullName||e.nameWithInitials||e.epfNo||"Unnamed"}),(0,l.jsxs)("div",{className:"text-[11px] text-gray-600",children:[e.epfNo?"EPF ".concat(e.epfNo):"No EPF",e.department?" • ".concat(e.department):""]})]},e.epfNo||e.id||t)):(0,l.jsx)("div",{className:"px-3 py-2 text-[12px] text-gray-500",children:"No employees match your search."})}):null,k?(0,l.jsxs)("p",{className:"mt-1 text-[11px] text-gray-600",children:["Selected: ",k.fullName||k.nameWithInitials||"Employee"," (",k.epfNo||"No EPF",")"]}):(0,l.jsx)("p",{className:"mt-1 text-[11px] text-orange-700",children:"Pick an employee to auto-fill EPF, phone and email. You can still edit the fields below."}),S&&!C?(0,l.jsx)("p",{className:"mt-1 text-[11px] text-red-600",children:S}):null,y.name&&(0,l.jsx)("p",{className:"text-xs text-red-600 mt-1",children:String(y.name.message)})]}),(0,l.jsxs)("div",{children:[(0,l.jsxs)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:["Employee ID (EPF) ",(0,l.jsx)("span",{className:"text-red-600",children:"*"})]}),(0,l.jsx)("input",{className:"w-full px-4 py-2.5 rounded-lg border focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all ".concat(y.employeeId?"border-red-500":"border-orange-200"),...z,placeholder:"E.g., EPF-1001",onFocus:()=>{R.current&&(clearTimeout(R.current),R.current=null),F(!0),Y(V)},onChange:e=>{z.onChange(e),R.current&&(clearTimeout(R.current),R.current=null),F(!0),Y(e.target.value),k&&""===e.target.value.trim()&&(P(null),j("name","",{shouldDirty:!0,shouldValidate:!0}))},onBlur:e=>{z.onBlur(e),R.current=setTimeout(()=>F(!1),120)}}),y.employeeId&&(0,l.jsx)("p",{className:"text-xs text-red-600 mt-1",children:String(y.employeeId.message)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"Phone"}),(0,l.jsx)("input",{className:"w-full px-4 py-2.5 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all",...g("phone"),placeholder:"Phone number"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"Email"}),(0,l.jsx)("input",{type:"email",className:"w-full px-4 py-2.5 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all",...g("email"),placeholder:"email@example.com"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"License Number"}),(0,l.jsx)("input",{className:"w-full px-4 py-2.5 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all",...g("licenseNumber"),placeholder:"License number"})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"License Expiry Date"}),(0,l.jsx)("input",{type:"date",className:"w-full px-4 py-2.5 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all",...g("licenseExpiryDate")})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"Driving Experience (years)"}),(0,l.jsx)("input",{type:"number",className:"w-full px-4 py-2.5 rounded-lg border focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all ".concat(y.drivingExperience?"border-red-500":"border-orange-200"),...g("drivingExperience",{min:{value:0,message:"Experience cannot be negative"},validate:e=>null==e||""===e.toString().trim()||!isNaN(Number(e))||"Enter a valid number"}),placeholder:"Years of experience"}),y.drivingExperience&&(0,l.jsx)("p",{className:"text-xs text-red-600 mt-1",children:String(y.drivingExperience.message)})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("label",{className:"block text-sm font-semibold text-orange-800 mb-2",children:"Status"}),(0,l.jsx)("select",{className:"w-full px-4 py-2.5 rounded-lg border border-orange-200 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-all bg-white",...g("status"),children:f.map(e=>(0,l.jsx)("option",{value:e,children:e},e))})]})]})]}),(0,l.jsxs)("div",{className:"px-6 py-4 border-t border-orange-200 bg-orange-100 mt-6 -mx-6 -mb-5 flex justify-end gap-3",children:[(0,l.jsx)("button",{className:"px-5 py-2.5 rounded-lg bg-orange-200 text-orange-800 hover:bg-orange-300 transition-all font-semibold",type:"button",onClick:x,children:"Cancel"}),(0,l.jsx)("button",{className:"px-5 py-2.5 rounded-lg bg-orange-600 text-white hover:bg-orange-700 transition-all font-semibold shadow-md hover:shadow-lg",type:"submit",children:u?"Update Driver":"Add Driver"})]})]})]})})}var N=r(89910),j=r(80452),w=r(51871),E=r(78827),A=r(7640),D=r(6257),C=r(4259);let I="text-xs",S="px-2",T="py-2",k="text-xs font-semibold text-orange-800",P="py-2",L=e=>null==e||""===e?"-":String(e),F=e=>e?new Date(e).toLocaleDateString():"-",R=e=>e?new Date(e).toLocaleString():"-";function M(){var e,t,r,h,b,v,f,M,z,U,V;let B=(0,n.useRouter)(),{user:Y}=(0,C.A)(),_=((null==Y?void 0:Y.roles)||[]).map(e=>e.toUpperCase()),q=((null==Y?void 0:Y.permissions)||[]).map(e=>e.toUpperCase()),H=_.some(e=>["ADMIN","TRANSPORT_ADMIN"].includes(e)),W=H||q.includes("CREATE"),O=H||q.includes("UPDATE"),G=H||q.includes("DELETE"),J=H||q.includes("PRINT")||q.includes("READ"),[K,Q]=(0,a.useState)("ALL"),[X,Z]=(0,a.useState)([]),[$,ee]=(0,a.useState)([]),[et,er]=(0,a.useState)(!1),[el,ea]=(0,a.useState)(!0),[en,es]=(0,a.useState)(""),[eo,ei]=(0,a.useState)(1),[ec,ed]=(0,a.useState)(null),[eu,em]=(0,a.useState)(!1),[ex,eg]=(0,a.useState)(null),[ep,eh]=(0,a.useState)(null),eb=async()=>{ea(!0);try{let[e,t]=await Promise.all([(0,p.UU)(),(0,p.z)()]);Z(Array.isArray(e)?e:[]),ee(Array.isArray(t)?t:[])}catch(e){s.oR.error(e instanceof Error?e.message:"Failed to load drivers"),Z([]),ee([])}finally{ea(!1)}};(0,a.useEffect)(()=>{eb()},[]);let ev=et?$:X,ef=(0,a.useMemo)(()=>{let e=en.trim().toLowerCase(),t="ALL"===K?ev||[]:(ev||[]).filter(e=>(e.status||"ACTIVE").toUpperCase()===K.toUpperCase());return e?t.filter(t=>[t.employeeId,t.name,t.phone,t.email,t.licenseNumber,t.licenseExpiryDate,t.drivingExperience,t.status].map(e=>(null!=e?e:"").toString().toLowerCase()).join(" ").includes(e)):t},[ev,en,K]);(0,a.useEffect)(()=>{ei(1)},[en,et]);let ey=Math.max(1,Math.ceil((null!=(e=null==ef?void 0:ef.length)?e:0)/10)),eN=(eo-1)*10,ej=(null!=ef?ef:[]).slice(eN,eN+10),ew=e=>ei(Math.min(ey,Math.max(1,e))),eE=async e=>{if(!W)return void s.oR.error("You do not have permission to add drivers.");try{await (0,p.IY)(e),s.oR.success("Driver added successfully"),em(!1),await eb()}catch(e){s.oR.error(e instanceof Error?e.message:"Failed to add driver")}},eA=async e=>{if(!O)return void s.oR.error("You do not have permission to update drivers.");try{if(!(null==ex?void 0:ex.employeeId))throw Error("No driver selected for editing");await (0,p.cI)(ex.employeeId,e),s.oR.success("Driver updated successfully"),em(!1),eg(null),await eb()}catch(e){s.oR.error(e instanceof Error?e.message:"Failed to update driver")}},eD=async()=>{if(!G)return void s.oR.error("You do not have permission to delete drivers.");if(null==ep?void 0:ep.employeeId)try{await (0,p.gP)(ep.employeeId),s.oR.success("Driver deleted successfully"),eh(null),await eb()}catch(e){s.oR.error(e instanceof Error?e.message:"Failed to delete driver")}},eC=async(e,t)=>{try{await (0,p.cI)(e.employeeId,{status:t}),s.oR.success("Status updated"),await eb()}catch(e){s.oR.error(e instanceof Error?e.message:"Failed to change status")}},eI=["w-[5%]","w-[10%]","w-[12%]","w-[10%]","w-[15%]","w-[10%]","w-[8%]","w-[12%]","w-[8%]","w-[10%]"],eS=eI.slice(0,-1),eT=et?eS:eI;return(0,l.jsxs)("div",{className:"w-full min-h-screen p-4 bg-orange-50",children:[(0,l.jsxs)("div",{className:"bg-white rounded-xl shadow-md p-4",children:[(0,l.jsxs)("div",{className:"flex items-center mb-4",children:[(0,l.jsx)("button",{onClick:()=>B.back(),className:"flex items-center gap-2 text-orange-600 hover:text-orange-800 p-2 rounded-lg hover:bg-orange-50 mr-4",children:(0,l.jsx)(c.A,{size:20})}),(0,l.jsxs)("div",{children:[(0,l.jsx)("h1",{className:"text-xl font-bold text-gray-800",children:"Driver Management"}),(0,l.jsxs)("p",{className:"text-sm text-orange-600",children:[null!=(t=null==ef?void 0:ef.length)?t:0," ",et?"deleted":"active"," drivers"]})]})]}),(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4 mb-4",children:[(0,l.jsx)("div",{className:"flex flex-wrap items-center gap-3",children:(0,l.jsxs)("div",{className:"flex rounded-lg overflow-hidden border border-orange-300 shadow-sm",children:[(0,l.jsxs)("button",{className:"px-4 py-2 text-sm font-medium ".concat(et?"bg-white text-orange-600 hover:bg-orange-50":"bg-orange-600 text-white"),onClick:()=>er(!1),children:["Active",(0,l.jsx)("span",{className:"ml-2 text-xs bg-orange-100 text-orange-800 px-2 py-0.5 rounded-full",children:X.length})]}),(0,l.jsxs)("button",{className:"px-4 py-2 text-sm font-medium ".concat(et?"bg-red-600 text-white":"bg-white text-red-600 hover:bg-red-50"),onClick:()=>er(!0),children:["Deleted",(0,l.jsx)("span",{className:"ml-2 text-xs bg-red-100 text-red-800 px-2 py-0.5 rounded-full",children:$.length})]})]})}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[!et&&(0,l.jsx)("div",{className:"flex items-center gap-1 bg-orange-50 border border-orange-200 px-2 py-1.5 rounded-lg text-xs sm:text-sm text-orange-800 shadow-sm",children:["ALL","ACTIVE","INACTIVE","SUSPENDED"].map(e=>(0,l.jsx)("button",{onClick:()=>Q(e),className:"px-2 py-1 rounded transition-colors ".concat(K===e?"bg-orange-600 text-white":"hover:bg-orange-100"),children:e.replace("_"," ")},e))}),(0,l.jsxs)("div",{className:"flex flex-wrap items-center gap-2",children:[W&&!et&&(0,l.jsxs)("button",{className:"flex items-center gap-2 bg-orange-600 text-white px-3 py-2 rounded-lg hover:bg-orange-700 shadow-sm transition-colors text-sm",onClick:()=>{eg(null),em("add")},children:[(0,l.jsx)(d.A,{size:16}),(0,l.jsx)("span",{children:"Add Driver"})]}),J&&(0,l.jsxs)("button",{className:"flex items-center gap-2 bg-orange-100 text-orange-700 border border-orange-200 px-3 py-2 rounded-lg hover:bg-orange-200 shadow-sm transition-colors text-sm",onClick:()=>(0,D.om)(ef,et),children:[(0,l.jsx)(u.A,{size:16}),(0,l.jsx)("span",{children:"Print"})]})]})]})]}),(0,l.jsx)(E.A,{value:en,onChange:es,placeholder:"Search any field (ID, name, phone, email…)"}),el?(0,l.jsxs)("div",{className:"text-center py-16 text-gray-500",children:[(0,l.jsx)("div",{className:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-orange-600 mb-3"}),(0,l.jsx)("p",{children:"Loading drivers..."})]}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"overflow-x-auto rounded-lg border border-orange-100 mt-4 shadow-sm",children:(0,l.jsxs)("table",{className:"w-full",children:[(0,l.jsx)("colgroup",{children:eT.map((e,t)=>(0,l.jsx)("col",{className:e},t))}),(0,l.jsx)("thead",{className:"bg-orange-50 sticky top-0 z-10",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)(A.Th,{className:"text-center ".concat(P," ").concat(k),children:"No"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Employee ID"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Name"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Phone"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Email"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"License NO"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Experience (yrs)"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"License Expiry"}),(0,l.jsx)(A.Th,{className:"".concat(P," ").concat(k),children:"Status"}),!et&&(O||G||J)&&(0,l.jsx)(A.Th,{className:"text-center ".concat(P," ").concat(k),children:"Actions"})]})}),(0,l.jsxs)("tbody",{className:"divide-y divide-orange-100",children:[ej.map((e,t)=>{let r=function(e){if(!e)return{label:"—",chip:"bg-gray-100 text-gray-700"};let t=new Date(e);if(isNaN(t.getTime()))return{label:"—",chip:"bg-gray-100 text-gray-700"};let r=new Date;r.setHours(0,0,0,0);let l=Math.ceil((t.getTime()-r.getTime())/864e5);return l<0?{label:"Expired (".concat(F(e),")"),chip:"bg-red-100 text-red-700"}:l<=30?{label:"Expiring Soon (".concat(F(e),")"),chip:"bg-amber-100 text-amber-800"}:{label:"Valid (".concat(F(e),")"),chip:"bg-green-100 text-green-700"}}(e.licenseExpiryDate);return(0,l.jsxs)("tr",{className:"hover:bg-orange-50 transition-colors cursor-pointer",onClick:()=>ed(e),children:[(0,l.jsx)(A.Td,{className:"text-center ".concat(S," ").concat(T," ").concat(I),children:eN+t+1}),(0,l.jsx)(A.Td,{className:"".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.employeeId),children:(0,l.jsx)("span",{className:"font-medium",children:L(e.employeeId)})}),(0,l.jsx)(A.Td,{className:"".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.name),children:L(e.name)}),(0,l.jsx)(A.Td,{className:"".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.phone),children:L(e.phone)}),(0,l.jsx)(A.Td,{className:"".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.email),children:L(e.email)}),(0,l.jsx)(A.Td,{className:"".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.licenseNumber),children:L(e.licenseNumber)}),(0,l.jsx)(A.Td,{className:"text-center ".concat(S," ").concat(T," ").concat(I," truncate"),title:L(e.drivingExperience),children:L(e.drivingExperience)}),(0,l.jsx)(A.Td,{className:"text-center ".concat(S," ").concat(T," ").concat(I),title:F(e.licenseExpiryDate),children:(0,l.jsx)("span",{className:"inline-block rounded px-2 py-0.5 text-xs ".concat(r.chip),children:r.label})}),(0,l.jsx)(A.Td,{className:"text-center ".concat(S," ").concat(T),onClick:e=>e.stopPropagation(),children:(0,l.jsx)(w.A,{mode:"driver",value:e.status,editable:!et&&O,onChange:t=>eC(e,t)})}),!et&&(O||G||J)&&(0,l.jsx)(A.Td,{className:"text-center ".concat(S," ").concat(T),onClick:e=>e.stopPropagation(),children:(0,l.jsxs)("div",{className:"flex items-center justify-center gap-1",children:[J&&(0,l.jsx)("button",{className:"w-6 h-6 grid place-items-center rounded text-orange-600 hover:bg-orange-100 transition-colors",onClick:()=>(0,D.aB)(e),title:"Print","aria-label":"Print",children:(0,l.jsx)(u.A,{size:14})}),(0,l.jsx)("button",{className:"w-6 h-6 grid place-items-center rounded text-orange-600 hover:bg-orange-100 transition-colors",onClick:()=>B.push("/Akeel/Transport/History?type=Driver&id=".concat(encodeURIComponent(e.employeeId))),title:"History","aria-label":"History",children:(0,l.jsx)(m.A,{size:14})}),O&&(0,l.jsx)("button",{className:"w-6 h-6 grid place-items-center rounded text-green-600 hover:bg-green-100 transition-colors",onClick:()=>{eg(e),em("edit")},title:"Edit","aria-label":"Edit",children:(0,l.jsx)(x.A,{size:14})}),G&&(0,l.jsx)("button",{className:"w-6 h-6 grid place-items-center rounded text-red-600 hover:bg-red-100 transition-colors",onClick:()=>eh(e),title:"Delete","aria-label":"Delete",children:(0,l.jsx)(g.A,{size:14})})]})})]},e.employeeId)}),(null!=(r=null==ej?void 0:ej.length)?r:0)===0&&(0,l.jsx)("tr",{children:(0,l.jsxs)(A.Td,{colSpan:et?9:10,className:"text-center py-6 text-gray-500",children:["No ",et?"deleted":"active"," drivers found."]})})]})]})}),(0,l.jsx)(()=>{if(!ef.length)return null;let e=Math.max(1,eo-Math.floor(2.5)),t=Math.min(ey,e+5-1),r=[];for(let l=e;l<=t;l++)r.push(l);return(0,l.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 bg-orange-50 rounded-lg border border-orange-100 mt-4",children:[(0,l.jsxs)("span",{className:"text-xs text-orange-800",children:["Showing ",ef.length?eN+1:0,"–",Math.min(eN+10,ef.length)," of ",ef.length]}),(0,l.jsxs)("div",{className:"flex items-center gap-1 sm:gap-2",children:[(0,l.jsx)("button",{onClick:()=>ew(eo-1),disabled:1===eo,className:"p-2 rounded-md ".concat(1===eo?"text-gray-400 cursor-not-allowed":"text-orange-600 hover:bg-orange-100"),"aria-label":"Previous page",children:(0,l.jsx)(o.A,{size:16})}),e>1&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("button",{onClick:()=>ew(1),className:"px-3 py-1 rounded-md ".concat(1===eo?"bg-orange-600 text-white":"text-orange-600 hover:bg-orange-100"),children:"1"}),e>2&&(0,l.jsx)("span",{className:"px-1",children:"…"})]}),r.map(e=>(0,l.jsx)("button",{onClick:()=>ew(e),className:"px-3 py-1 rounded-md ".concat(eo===e?"bg-orange-600 text-white":"text-orange-600 hover:bg-orange-100"),children:e},e)),t<ey&&(0,l.jsxs)(l.Fragment,{children:[t<ey-1&&(0,l.jsx)("span",{className:"px-1",children:"…"}),(0,l.jsx)("button",{onClick:()=>ew(ey),className:"px-3 py-1 rounded-md ".concat(eo===ey?"bg-orange-600 text-white":"text-orange-600 hover:bg-orange-100"),children:ey})]}),(0,l.jsx)("button",{onClick:()=>ew(eo+1),disabled:eo===ey,className:"p-2 rounded-md ".concat(eo===ey?"text-gray-400 cursor-not-allowed":"text-orange-600 hover:bg-orange-100"),"aria-label":"Next page",children:(0,l.jsx)(i.A,{size:16})})]})]})},{})]})]}),eu&&(0,l.jsx)(y,{driver:"edit"===eu&&null!=ex?ex:void 0,onSubmit:"edit"===eu?eA:eE,onClose:()=>em(!1)}),ep&&(0,l.jsx)(N.A,{title:"Delete Driver",message:"Are you sure you want to delete ".concat(ep.name,"?"),onConfirm:eD,onClose:()=>eh(null)}),ec&&(0,l.jsx)(j.A,{title:"Driver Details",onClose:()=>ed(null),fields:[{label:"Employee ID",value:ec.employeeId},{label:"Name",value:ec.name},{label:"Phone",value:null!=(h=ec.phone)?h:"-"},{label:"Email",value:null!=(b=ec.email)?b:"-"},{label:"License Number",value:null!=(v=ec.licenseNumber)?v:"-"},{label:"License Expiry",value:F(ec.licenseExpiryDate)},{label:"Experience (years)",value:null!=(f=ec.drivingExperience)?f:"-"},{label:"Status",value:null!=(M=ec.status)?M:"-"},{label:"Created By",value:null!=(z=ec.createdBy)?z:"-"},{label:"Created At",value:R(ec.createdAt)},{label:"Last Modified By",value:null!=(U=ec.updatedBy)?U:"-"},{label:"Last Modified At",value:R(ec.updatedAt)},{label:"Deleted By",value:null!=(V=ec.deletedBy)?V:"-"},{label:"Deleted At",value:R(ec.deletedAt)}]})]})}}}]);