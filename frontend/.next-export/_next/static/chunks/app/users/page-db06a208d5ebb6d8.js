(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5009],{18365:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>D});var t=r(95155),a=r(12115),l=r(43566),n=r(36710),o=r(67097),i=r(5354),d=r(42529),c=r(78874),m=r(75426),u=r(37621);function x(e){let{isOpen:s,onClose:r,targetUser:l}=e,[n,i]=(0,a.useState)(""),[x,h]=(0,a.useState)(""),[g,p]=(0,a.useState)(""),[b,f]=(0,a.useState)(!1),j=async()=>{if(!(null==l?void 0:l.id))return void h("No user selected.");h(""),p(""),i("");try{f(!0);let{data:e}=await u.A.post("/users/".concat(l.id,"/reset-password"));(null==e?void 0:e.newPassword)&&(i(e.newPassword),p("Password reset successfully."))}catch(r){var e,s;h((null==r||null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"Failed to reset password")}finally{f(!1)}};return(0,t.jsx)(o.A,{isOpen:s,onClose:r,title:"Reset Password",onSubmit:j,submitText:b?"Processing...":"Reset Password",size:"md",loading:b,children:l?(0,t.jsxs)("div",{className:"space-y-4",children:[g&&(0,t.jsxs)("div",{className:"p-3 bg-green-50 border border-green-200 rounded-lg text-sm flex items-start gap-2",children:[(0,t.jsx)(d.A,{className:"w-4 h-4 text-green-600"}),(0,t.jsx)("div",{className:"text-green-800",children:g})]}),x&&(0,t.jsxs)("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg text-sm flex items-start gap-2",children:[(0,t.jsx)(c.A,{className:"w-4 h-4 text-red-600"}),(0,t.jsx)("div",{className:"text-red-800",children:x})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,t.jsx)("p",{className:"text-gray-900",children:l.username})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EPF No"}),(0,t.jsx)("p",{className:"text-gray-900",children:l.epfNo||"N/A"})]})]}),n&&(0,t.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-3 space-y-2",children:[(0,t.jsx)("p",{className:"text-sm text-green-800 font-semibold",children:"New Temporary Password"}),(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsx)("p",{className:"text-green-900 font-mono break-all text-sm",children:n}),(0,t.jsxs)("button",{onClick:()=>{navigator.clipboard.writeText(n),p("Password copied to clipboard.")},className:"flex items-center gap-1 px-2 py-1 bg-green-600 text-white rounded hover:bg-green-700 text-xs font-medium",children:[(0,t.jsx)(m.A,{className:"w-3 h-3"})," Copy"]})]}),(0,t.jsx)("p",{className:"text-xs text-green-700 mt-2",children:"Share this password with the employee. They should change it after logging in."})]})]}):(0,t.jsx)("div",{className:"text-gray-600 text-sm",children:"No user selected."})})}var h=r(4259),g=r(60049),p=r(11382),b=r(99947),f=r(91169),j=r(20508),v=r(86651),N=r(6191),y=r(39847),w=r(39867),A=r(309),S=r(17910),C=r(23664),E=r(11010),k=r(99708),R=r(90368),U=r(27937),P=r(9349),T=r.n(P);let F=e=>e&&""!==e.trim()?e:"N/A",_=e=>{if(null==e)return"—";if("string"==typeof e){let s=e.trim();return(0,p.ZD)(s.length?s:"—")}return(0,p.ZD)(String(e))};function D(){var e,s;let{user:r}=(0,h.A)(),m=(0,b.x)("cache:auth:users:list")||[],P=(0,b.x)("cache:auth:employees:list")||[],D=(0,b.x)("cache:auth:roles:list")||[],[L,O]=(0,a.useState)(m),[z,Y]=(0,a.useState)(P),[M,I]=(0,a.useState)(D),[B,q]=(0,a.useState)(""),[Z,H]=(0,a.useState)(1),[V,W]=(0,a.useState)(10),[G,J]=(0,a.useState)(!1),[K,Q]=(0,a.useState)(!1),[X,$]=(0,a.useState)(!1),[ee,es]=(0,a.useState)(!1),[er,et]=(0,a.useState)(!1),[ea,el]=(0,a.useState)(!1),[en,eo]=(0,a.useState)(!1),[ei,ed]=(0,a.useState)(null),[ec,em]=(0,a.useState)({username:"",email:"",password:"",role:""}),[eu,ex]=(0,a.useState)({username:"",email:"",role:""}),[eh,eg]=(0,a.useState)(""),[ep,eb]=(0,a.useState)(""),[ef,ej]=(0,a.useState)(""),[ev,eN]=(0,a.useState)(""),[ey,ew]=(0,a.useState)(null),[eA,eS]=(0,a.useState)(""),[eC,eE]=(0,a.useState)(""),ek=m.length>0||P.length>0,[eR,eU]=(0,a.useState)(!ek),[eP,eT]=(0,a.useState)(!1),{canRead:eF,canCreate:e_,canUpdate:eD,canPrint:eL}=(0,g.a)(),eO=(0,a.useMemo)(()=>{let e=B.toLowerCase();return L.filter(s=>{var r,t,a,l;return(null==(r=s.username)?void 0:r.toLowerCase().includes(e))||(null==(t=s.fullName)?void 0:t.toLowerCase().includes(e))||(null==(a=s.email)?void 0:a.toLowerCase().includes(e))||(null==(l=s.epfNo)?void 0:l.toLowerCase().includes(e))||(s.roles||[]).some(s=>s.toLowerCase().includes(e))})},[L,B]);(0,a.useEffect)(()=>{H(1)},[B,V]);let ez=Math.max(1,Math.ceil(eO.length/V)),eY=Math.min(Z,ez),eM=(eY-1)*V,eI=eO.slice(eM,eM+V);(0,a.useEffect)(()=>{if(!r)return;let e=!!ek;r&&eF?(eq({silent:e}),eZ({silent:e})):(O([]),Y([])),eH({silent:e})},[r,eF]);let eB=function(e){let s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e4,r=new AbortController,t=setTimeout(()=>r.abort(),s);return{run:e(r.signal).finally(()=>clearTimeout(t))}},eq=async e=>{(null==e?void 0:e.silent)?eT(!0):eU(!0);let{run:s}=eB(e=>u.A.get("/users",{signal:e}),1e4);try{let{data:e}=await s,r=(Array.isArray(e)?e:[]).map(e=>({...e,roles:Array.isArray(e.roles)?e.roles:[],permissions:Array.isArray(e.permissions)?e.permissions:[]}));O(r),(0,b.a)("cache:auth:users:list",r)}catch(e){var r;(null==e||null==(r=e.response)?void 0:r.status)===403?eE("Forbidden (403): missing READ permission."):(null==e?void 0:e.name)==="CanceledError"||(null==e?void 0:e.code)==="ERR_CANCELED"||(null==e?void 0:e.name)==="AbortError"?eE("Fetching users timed out. Showing cached data."):eE("Failed to fetch users")}finally{eU(!1),eT(!1)}},eZ=async e=>{(null==e?void 0:e.silent)&&eT(!0);let{run:s}=eB(e=>u.A.get("/registrations",{signal:e}),1e4);try{let{data:e}=await s,r=Array.isArray(e)?e:[];Y(r),(0,b.a)("cache:auth:employees:list",r)}catch(e){console.error("Failed to fetch employees:",e),((null==e?void 0:e.name)==="CanceledError"||(null==e?void 0:e.code)==="ERR_CANCELED"||(null==e?void 0:e.name)==="AbortError")&&eE("Employee lookup timed out. Showing cached list.")}finally{eT(!1)}},eH=async e=>{(null==e?void 0:e.silent)&&eT(!0);let{run:s}=eB(e=>u.A.get("/roles",{signal:e}),1e4);try{let{data:e}=await s,r=Array.isArray(e)?e:[];I(r),(0,b.a)("cache:auth:roles:list",r)}catch(e){console.warn("Fetching roles may be restricted:",e)}finally{eT(!1)}},eV=async()=>{if(!e_)return void eE("You do not have permission (CREATE).");if(!ev)return void eE("Please select an employee");try{await u.A.post("/users/create-from-employee",ec,{params:{epfNo:ev}}),J(!1),eS("User created successfully!"),setTimeout(()=>eS(""),3e3),eF&&eq()}catch(r){var e,s;eE((null==r||null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"Failed to create user")}},eW=async()=>{if(eD&&ey)try{eu.email&&await u.A.put("/users/".concat(ey.id),{email:eu.email}),eu.role&&await u.A.post("/users/".concat(ey.id,"/assign-role"),{roleCode:eu.role}),Q(!1),eS("User updated successfully!"),setTimeout(()=>eS(""),3e3),eF&&eq()}catch(r){var e,s;eE((null==r||null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"Failed to update user")}},eG=async()=>{if(!eD)return void eE("You do not have permission (UPDATE).");if(!eh||!ep||!ef)return void eE("Please select source user, target user, and role");try{await u.A.post("/users/".concat(eh,"/transfer-role/").concat(ep,"/").concat(ef)),es(!1),et(!0),eF&&eq()}catch(r){var e,s;eE((null==r||null==(s=r.response)||null==(e=s.data)?void 0:e.message)||"Failed to transfer role")}};if(!r)return(0,t.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-orange-100 flex items-center justify-center",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)("div",{className:"w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})});let eJ=eR&&0===L.length;return(0,t.jsxs)("div",{className:"auth-shell",children:[(0,t.jsx)(n.A,{user:r,isOpen:ea,onClose:()=>el(!1)}),(0,t.jsxs)("div",{className:"auth-shell__main overflow-hidden",children:[(0,t.jsx)(l.A,{user:r}),(0,t.jsxs)("main",{className:"auth-shell__content",children:[(0,t.jsxs)("div",{className:"mb-8",children:[(0,t.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,t.jsx)(f.A,{className:"w-8 h-8 text-orange-600"}),(0,t.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"User Management"})]}),(0,t.jsx)("p",{className:"text-gray-600",children:"Manage system users and their roles"}),eP&&(0,t.jsxs)("div",{className:"mt-2 text-xs text-orange-700 flex items-center gap-2",children:[(0,t.jsx)("div",{className:"w-3 h-3 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),"Updating latest data…"]})]}),eA&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[(0,t.jsx)(d.A,{className:"mr-2 text-green-600"}),(0,t.jsx)("span",{className:"text-green-800",children:eA})]}),eC&&(0,t.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center",children:[(0,t.jsx)(c.A,{className:"mr-2 text-red-600"}),(0,t.jsx)("span",{className:"text-red-800",children:eC})]}),(0,t.jsx)("div",{className:"space-y-8",children:(0,t.jsx)("div",{className:"w-full",children:(0,t.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-orange-200 overflow-hidden",children:[(0,t.jsx)("div",{className:"p-6 border-b border-orange-200 bg-orange-50",children:(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[(0,t.jsx)(j.A,{className:"w-5 h-5 text-orange-600"}),"System Users"]}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("label",{htmlFor:"userTableSearch",className:"sr-only",children:"Search users"}),(0,t.jsx)(v.A,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-400 w-4 h-4"}),(0,t.jsx)("input",{id:"userTableSearch",name:"userTableSearch",type:"text",placeholder:"Search users...",value:B,onChange:e=>q(e.target.value),className:"pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 text-sm"})]}),(0,t.jsxs)("div",{className:"flex flex-col",children:[(0,t.jsx)("label",{htmlFor:"userPageSize",className:"sr-only",children:"Users per page"}),(0,t.jsxs)("select",{id:"userPageSize",name:"userPageSize",value:V,onChange:e=>W(Number(e.target.value)),className:"py-2 px-3 border border-gray-300 rounded-lg text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:10,children:"10 / page"}),(0,t.jsx)("option",{value:15,children:"15 / page"})]})]})]})]})}),(0,t.jsx)("div",{className:"p-4 border-b border-gray-200 bg-white",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,t.jsx)(i.B,{require:"CREATE",children:(0,t.jsxs)("button",{onClick:()=>{if(!e_)return void eE("You do not have permission (CREATE).");em({username:"",email:"",password:"",role:""}),eN(""),J(!0),eE("")},className:"flex items-center px-4 py-2 bg-orange-600 text-white rounded-lg hover:bg-orange-700 transition-colors text-sm font-medium",children:[(0,t.jsx)(N.A,{className:"w-4 h-4 mr-2"}),"Add User"]})}),(0,t.jsx)(i.B,{require:"UPDATE",children:(0,t.jsxs)("button",{onClick:()=>es(!0),className:"flex items-center px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm font-medium",children:[(0,t.jsx)(y.A,{className:"w-4 h-4 mr-2"}),"Transfer Role"]})}),(0,t.jsx)(i.B,{require:"PRINT",children:(0,t.jsxs)("button",{onClick:()=>{if(!eL)return void eE("You do not have permission (PRINT).");let e=new Blob([T().unparse(L)],{type:"text/csv;charset=utf-8;"}),s=document.createElement("a");s.href=URL.createObjectURL(e),s.download="users.csv",s.click()},className:"flex items-center px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors text-sm font-medium",children:[(0,t.jsx)(w.A,{className:"w-4 h-4 mr-2"}),"Export CSV"]})}),eL&&(0,t.jsxs)("button",{onClick:()=>{var e;if(!eL)return void eE("You do not have permission (PRINT).");let s=eO.map((e,s)=>"\n        <tr>\n          <td>".concat(_(s+1),"</td>\n          <td>").concat(_(e.username),"</td>\n          <td>").concat(_(e.fullName),"</td>\n          <td>").concat(_(e.email),"</td>\n          <td>").concat(_(e.department),"</td>\n          <td>").concat(_((e.roles||[]).join(", ")),"</td>\n        </tr>\n      ")).join(""),t=eO.length?'<table class="spc-table">\n          <thead>\n            <tr>\n              <th>#</th>\n              <th>Username</th>\n              <th>Full Name</th>\n              <th>Email</th>\n              <th>Department</th>\n              <th>Roles</th>\n            </tr>\n          </thead>\n          <tbody>'.concat(s,"</tbody>\n        </table>"):'<div class="spc-empty">No users match the current filters.</div>';(0,p.dq)({title:"System Users Report",subtitle:eO.length?"Records shown: ".concat(eO.length):void 0,contentHtml:t,printedBy:(null==r||null==(e=r.fullName)?void 0:e.trim())||(null==r?void 0:r.username)||void 0})},className:"flex items-center px-4 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm font-medium",children:[(0,t.jsx)(A.A,{className:"w-4 h-4 mr-2"}),"Print"]})]})}),eF?eJ?(0,t.jsxs)("div",{className:"p-8 space-y-3",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[(0,t.jsx)("div",{className:"w-4 h-4 border-2 border-orange-500 border-t-transparent rounded-full animate-spin"}),"Loading users..."]}),(0,t.jsx)("div",{className:"h-10 bg-orange-100/70 rounded animate-pulse"}),(0,t.jsx)("div",{className:"h-10 bg-orange-100/70 rounded animate-pulse"}),(0,t.jsx)("div",{className:"h-10 bg-orange-100/70 rounded animate-pulse"})]}):(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)("div",{className:"overflow-x-auto",children:(0,t.jsxs)("table",{className:"w-full",children:[(0,t.jsx)("thead",{className:"bg-orange-50",children:(0,t.jsxs)("tr",{children:[(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"Username"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"Full Name"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"Email"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"EPF No"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"Roles"}),(0,t.jsx)("th",{className:"p-3 text-left text-sm font-semibold text-gray-700",children:"Actions"})]})}),(0,t.jsx)("tbody",{className:"divide-y divide-gray-200",children:eI.length>0?eI.map(e=>(0,t.jsxs)("tr",{className:"hover:bg-orange-50 transition-colors cursor-pointer",onClick:()=>{ew(e),$(!0)},children:[(0,t.jsx)("td",{className:"p-3",children:(0,t.jsx)("div",{className:"font-medium text-gray-900",children:e.username})}),(0,t.jsx)("td",{className:"p-3 text-gray-900",children:e.fullName||"N/A"}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsxs)("div",{className:"text-gray-600 flex items-center gap-2",children:[(0,t.jsx)(C.A,{className:"w-4 h-4 text-gray-400"}),e.email||"N/A"]})}),(0,t.jsx)("td",{className:"p-3 text-gray-600",children:e.epfNo||"N/A"}),(0,t.jsx)("td",{className:"p-3",children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-1",children:[(e.roles||[]).map(e=>(0,t.jsx)("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded text-xs font-medium",children:e},e)),0===(e.roles||[]).length&&(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"N/A"})]})}),(0,t.jsx)("td",{className:"p-3",onClick:e=>e.stopPropagation(),children:(0,t.jsxs)("div",{className:"flex flex-wrap gap-2",children:[eL&&(0,t.jsxs)("button",{onClick:()=>(e=>{var s;if(!eL)return void eE("You do not have permission (PRINT).");let t=(e.roles||[]).length>0?(e.roles||[]).map(e=>'<span class="spc-chip spc-chip--role">'.concat(_(e),"</span>")).join(""):'<div class="spc-empty">No roles assigned.</div>',a=(e.permissions||[]).length>0?(e.permissions||[]).map(e=>'<span class="spc-chip spc-chip--perm">'.concat(_(e),"</span>")).join(""):'<div class="spc-empty">No permissions assigned.</div>',l='\n      <div class="spc-section">\n        <p class="spc-section__title">Account Information</p>\n        <table class="spc-definition">\n          <tr><td>Username</td><td>'.concat(_(e.username),"</td></tr>\n          <tr><td>Full Name</td><td>").concat(_(e.fullName),"</td></tr>\n          <tr><td>Email</td><td>").concat(_(e.email),"</td></tr>\n          <tr><td>EPF No</td><td>").concat(_(e.epfNo),"</td></tr>\n          <tr><td>Department</td><td>").concat(_(e.department),'</td></tr>\n        </table>\n      </div>\n      <div class="spc-section">\n        <p class="spc-section__title">Roles</p>\n        ').concat(t,'\n      </div>\n      <div class="spc-section">\n        <p class="spc-section__title">Effective Permissions</p>\n        ').concat(a,"\n      </div>\n    ");(0,p.dq)({title:"User Profile",subtitle:"Username: ".concat(F(e.username)),contentHtml:l,printedBy:(null==r||null==(s=r.fullName)?void 0:s.trim())||(null==r?void 0:r.username)||void 0})})(e),className:"flex items-center px-3 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 transition-colors text-sm",children:[(0,t.jsx)(A.A,{className:"w-4 h-4 mr-1"}),"Print"]}),eD&&(0,t.jsxs)("button",{onClick:()=>(e=>{if(!eD)return void eE("You do not have permission (UPDATE).");ew(e),ex({username:e.username,email:e.email||"",role:""}),Q(!0),eE("")})(e),className:"flex items-center px-3 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors text-sm",children:[(0,t.jsx)(E.A,{className:"w-4 h-4 mr-1"}),"Edit"]}),eD&&(0,t.jsxs)("button",{onClick:()=>{var s;eg((null==(s=e.id)?void 0:s.toString())||""),eb(""),ej(""),es(!0)},className:"flex items-center px-3 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors text-sm",children:[(0,t.jsx)(y.A,{className:"w-4 h-4 mr-1"}),"Transfer"]}),eD&&(0,t.jsxs)("button",{onClick:()=>(e=>{if(!eD)return void eE("You do not have permission (UPDATE).");ed(e),eo(!0)})(e),className:"flex items-center px-3 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors text-sm",children:[(0,t.jsx)(k.A,{className:"w-4 h-4 mr-1"}),"Reset PW"]})]})})]},e.id)):(0,t.jsx)("tr",{children:(0,t.jsx)("td",{colSpan:6,className:"p-6 text-center text-gray-500",children:B?"No matching users found":"No users available"})})})]})}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between p-4 border-t border-gray-200 text-sm bg-white",children:[(0,t.jsxs)("div",{className:"text-gray-600 mb-3 sm:mb-0",children:["Page ",eY," / ",ez," • Showing"," ",(0,t.jsx)("span",{className:"font-medium",children:eI.length})," ","of"," ",(0,t.jsx)("span",{className:"font-medium",children:eO.length.toString()})," ","users"]}),(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)("button",{onClick:()=>H(e=>Math.max(1,e-1)),disabled:1===eY,className:"flex items-center px-3 py-2 rounded-lg border text-sm ".concat(1===eY?"text-gray-400 border-gray-200 bg-gray-50 cursor-not-allowed":"text-gray-700 border-gray-300 bg-white hover:bg-gray-100"),children:[(0,t.jsx)(R.A,{className:"w-4 h-4 mr-1"}),"Prev"]}),(0,t.jsxs)("button",{onClick:()=>H(e=>Math.min(ez,e+1)),disabled:eY===ez,className:"flex items-center px-3 py-2 rounded-lg border text-sm ".concat(eY===ez?"text-gray-400 border-gray-200 bg-gray-50 cursor-not-allowed":"text-gray-700 border-gray-300 bg-white hover:bg-gray-100"),children:["Next",(0,t.jsx)(U.A,{className:"w-4 h-4 ml-1"})]})]})]})]}):(0,t.jsxs)("div",{className:"p-8 text-center",children:[(0,t.jsx)(S.A,{className:"w-12 h-12 text-gray-400 mx-auto mb-3"}),(0,t.jsxs)("p",{className:"text-gray-600",children:["You don't have permission to view users (need"," ",(0,t.jsx)("code",{className:"bg-gray-100 px-2 py-1 rounded text-sm",children:"READ"})," ","permission)."]})]})]})})}),(0,t.jsx)(o.A,{isOpen:G,onClose:()=>J(!1),title:"Add User from Employee",onSubmit:eV,submitText:"Create User",size:"md",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Employee *"}),(0,t.jsxs)("select",{value:ev,onChange:e=>eN(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Employee EPF"}),z.filter(e=>!L.some(s=>s.epfNo===e.epfNo)).map(e=>(0,t.jsxs)("option",{value:e.epfNo,children:[e.epfNo," - ",e.fullName]},e.epfNo))]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"createUsername",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username *"}),(0,t.jsx)("input",{id:"createUsername",name:"username",placeholder:"Username",value:ec.username,onChange:e=>em({...ec,username:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"createEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,t.jsx)("input",{id:"createEmail",name:"email",placeholder:"Email",value:ec.email,onChange:e=>em({...ec,email:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"createPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password *"}),(0,t.jsx)("input",{id:"createPassword",name:"password",type:"password",placeholder:"Password",value:ec.password,onChange:e=>em({...ec,password:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"createRole",className:"block text-sm font-medium text-gray-700 mb-2",children:"Initial Role"}),(0,t.jsxs)("select",{id:"createRole",name:"initialRole",value:ec.role,onChange:e=>em({...ec,role:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Initial Role"}),M.map(e=>(0,t.jsxs)("option",{value:e.code,children:[e.code," - ",e.name]},e.code))]})]})]})}),(0,t.jsx)(o.A,{isOpen:K,onClose:()=>Q(!1),title:"Update User",onSubmit:eW,submitText:"Update User",size:"md",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editUsername",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username"}),(0,t.jsx)("input",{id:"editUsername",name:"editUsername",placeholder:"Username",value:eu.username,disabled:!0,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 opacity-75"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editEmail",className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),(0,t.jsx)("input",{id:"editEmail",name:"editEmail",placeholder:"Email",value:eu.email,onChange:e=>ex({...eu,email:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500"})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{htmlFor:"editAssignRole",className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign Additional Role"}),(0,t.jsxs)("select",{id:"editAssignRole",name:"editAssignRole",value:eu.role,onChange:e=>ex({...eu,role:e.target.value}),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Role to Assign"}),M.map(e=>(0,t.jsxs)("option",{value:e.code,children:[e.code," - ",e.name]},e.code))]})]})]})}),(0,t.jsx)(o.A,{isOpen:X,onClose:()=>$(!1),title:"User Details",size:"md",showFooter:!1,children:ey&&(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Username"}),(0,t.jsx)("p",{className:"text-gray-900",children:ey.username})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Full Name"}),(0,t.jsx)("p",{className:"text-gray-900",children:F(ey.fullName)})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Email"}),(0,t.jsx)("p",{className:"text-gray-900",children:F(ey.email)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"EPF No"}),(0,t.jsx)("p",{className:"text-gray-900",children:F(ey.epfNo)})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Department"}),(0,t.jsx)("p",{className:"text-gray-900",children:F(ey.department)})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Roles"}),(0,t.jsx)("div",{className:"flex flex-wrap gap-1",children:(ey.roles||[]).length>0?ey.roles.map(e=>(0,t.jsx)("span",{className:"bg-orange-100 text-orange-700 px-2 py-1 rounded text-xs font-medium",children:e},e)):(0,t.jsx)("span",{className:"text-gray-500 text-sm",children:"No roles assigned"})})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Effective Permissions"}),(0,t.jsx)("div",{className:"text-sm text-gray-900 break-words",children:(ey.permissions||[]).length>0?ey.permissions.join(", "):"N/A"})]})]})}),(0,t.jsx)(o.A,{isOpen:ee,onClose:()=>es(!1),title:"Transfer Role",onSubmit:eG,submitText:"Transfer Role",size:"md",children:(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"From User *"}),(0,t.jsxs)("select",{value:eh,onChange:e=>{eg(e.target.value),ej("")},className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Source User"}),L.map(e=>{var s;return(0,t.jsxs)("option",{value:null==(s=e.id)?void 0:s.toString(),children:[e.username," - Roles:"," ",(e.roles||[]).join(", ")||"N/A"]},e.id)})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"To User *"}),(0,t.jsxs)("select",{value:ep,onChange:e=>eb(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Target User"}),L.filter(e=>{var s;return(null==(s=e.id)?void 0:s.toString())!==eh}).map(e=>{var s;return(0,t.jsxs)("option",{value:null==(s=e.id)?void 0:s.toString(),children:[e.username," - Roles:"," ",(e.roles||[]).join(", ")||"N/A"]},e.id)})]})]}),(0,t.jsxs)("div",{children:[(0,t.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Role to Transfer *"}),(0,t.jsxs)("select",{value:ef,onChange:e=>ej(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",children:[(0,t.jsx)("option",{value:"",children:"Select Role"}),null==(s=L.find(e=>{var s;return(null==(s=e.id)?void 0:s.toString())===eh}))||null==(e=s.roles)?void 0:e.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]})]})}),(0,t.jsx)(o.A,{isOpen:er,onClose:()=>et(!1),title:"Transfer Successful",onSubmit:()=>{et(!1),eS("Role transferred successfully!"),setTimeout(()=>eS(""),3e3)},submitText:"Confirm",size:"sm",children:(0,t.jsxs)("div",{className:"text-center",children:[(0,t.jsx)(d.A,{className:"w-12 h-12 text-green-500 mx-auto mb-4"}),(0,t.jsx)("p",{className:"text-gray-700 mb-2",children:"Role transferred successfully!"}),(0,t.jsx)("p",{className:"text-sm text-gray-500",children:"Click confirm to continue."})]})}),(0,t.jsx)(x,{isOpen:en,onClose:()=>eo(!1),targetUser:ei}),(0,t.jsx)("button",{onClick:()=>el(!0),className:"md:hidden fixed bottom-6 right-6 w-14 h-14 bg-orange-600 text-white rounded-full shadow-lg hover:bg-orange-700 transition-all flex items-center justify-center z-40",children:(0,t.jsx)("span",{className:"text-lg font-bold",children:"☰"})})]})]})]})}},46150:(e,s,r)=>{Promise.resolve().then(r.bind(r,18365))}},e=>{e.O(0,[5125,6394,2619,9447,9136,3566,9022,8441,1255,7358],()=>e(e.s=46150)),_N_E=e.O()}]);