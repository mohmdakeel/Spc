(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[178],{3355:(e,t,s)=>{Promise.resolve().then(s.bind(s,34710))},7640:(e,t,s)=>{"use strict";s.d(t,{Td:()=>r,Th:()=>a});var l=s(95155);function a(e){let{children:t,className:s="",sortable:a,sortDirection:r,onClick:n,...i}=e;return(0,l.jsx)("th",{...i,"aria-sort":"asc"===r?"ascending":"desc"===r?"descending":"none",onClick:a?n:void 0,onKeyDown:a?e=>{a&&("Enter"===e.key||" "===e.key)&&(e.preventDefault(),null==n||n())}:void 0,tabIndex:a?0:void 0,className:["px-2 py-2 md:px-3 md:py-2.5 text-left font-semibold text-orange-900 whitespace-normal align-middle leading-snug bg-orange-100 border-b-2 border-orange-200",a?"cursor-pointer hover:bg-orange-200 transition-colors":"",r?"bg-orange-200":"",s].join(" "),children:(0,l.jsxs)("div",{className:"flex items-center gap-2 select-none",children:[t,a&&(0,l.jsx)("span",{"aria-hidden":"true",className:"text-orange-600",children:"asc"===r?"↑":"desc"===r?"↓":"↕"})]})})}function r(e){let{children:t,className:s="",highlight:a,...r}=e;return(0,l.jsx)("td",{...r,className:["px-2 py-2 md:px-3 md:py-2.5 align-top border-b border-orange-100 transition-colors duration-150 whitespace-normal break-words leading-snug text-orange-800",a?"bg-orange-50 font-medium":"",s].join(" "),children:t})}s(12115)},34710:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>A});var l=s(95155),a=s(12115),r=s(91811),n=s(99708),i=s(71847);let d=(0,i.A)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]);var c=s(46398);let o=(0,i.A)("calculator",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",key:"1nb95v"}],["line",{x1:"8",x2:"16",y1:"6",y2:"6",key:"x4nwl0"}],["line",{x1:"16",x2:"16",y1:"14",y2:"18",key:"wjye3r"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M8 14h.01",key:"6423bh"}],["path",{d:"M12 18h.01",key:"mhygvu"}],["path",{d:"M8 18h.01",key:"lrp35t"}]]);var x=s(80598);let u=(0,i.A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]);var g=s(86651),m=s(35299),h=s(71360),p=s(20063),y=s(2989),v=s(30409),b=s(7640),j=s(4259);let f="transport:fuel:prices",N="transport:fuel:overrides",w="transport:fuel:month",k=function(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:new Date;return"".concat(e.getFullYear(),"-").concat(String(e.getMonth()+1).padStart(2,"0"))},S=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return null==e||Number.isNaN(e)?"—":Number(e).toLocaleString(void 0,{maximumFractionDigits:t,minimumFractionDigits:t})},T=e=>null==e||Number.isNaN(e)?"—":e.toLocaleString(void 0,{style:"currency",currency:"LKR",maximumFractionDigits:0}),L=(e,t)=>{try{let s=localStorage.getItem(e);return s?JSON.parse(s):t}catch(e){return t}},C=(e,t)=>{try{localStorage.setItem(e,JSON.stringify(t))}catch(e){}};function A(){var e;let t=(0,p.useRouter)(),{user:s}=(0,j.A)(),[i,A]=a.useState([]),[E,D]=a.useState([]),[M,O]=a.useState(!0),[I,P]=a.useState(!1),[R,F]=a.useState(""),[K,V]=a.useState(()=>L(N,{})),[z,_]=a.useState(()=>L(f,{petrol:340,diesel:320})),[U,q]=a.useState(!0),[H,J]=a.useState(""),[W,B]=a.useState(""),[Y,G]=a.useState(()=>L(w,k())),[Q,X]=a.useState("ALL"),[Z,$]=a.useState(""),[ee,et]=a.useState(""),[es,el]=a.useState(""),[ea,er]=a.useState(null),[en,ei]=a.useState(120),[ed,ec]=a.useState(0),[eo,ex]=a.useState(0),[eu,eg]=a.useState(""),[em,eh]=a.useState(""),[ep,ey]=a.useState({vehicleId:"",startOdo:"",endOdo:"",litres:""}),[ev,eb]=a.useState(!1),[ej,ef]=a.useState(""),eN=a.useCallback(async()=>{O(!0);try{let e=await (0,y.WR)();A(Array.isArray(e)?e:[]),(null==e?void 0:e.length)&&!W&&(B(String(e[0].id)),ey(t=>({...t,vehicleId:String(e[0].id)})))}catch(e){console.error(e),A([])}finally{O(!1)}},[W]),ew=a.useCallback(async()=>{P(!0);try{let e=await (0,v.c)({month:Y||void 0,vehicleId:"ALL"!==Q?Q:void 0,from:Z||void 0,to:ee||void 0});D(e||[])}catch(e){console.error("Failed to load fuel logs",e),D([])}finally{P(!1)}},[Y,Q,Z,ee]);a.useEffect(()=>{eN()},[eN]),a.useEffect(()=>{ew()},[ew]),a.useEffect(()=>C(N,K),[K]),a.useEffect(()=>C(f,z),[z]),a.useEffect(()=>C(w,Y),[Y]);let ek=((null==s?void 0:s.username)||(null==s?void 0:s.id)||"").toString()||localStorage.getItem("username")||localStorage.getItem("actor")||"",eS="".concat("transport:fuel:pin:").concat(ek||"default");a.useEffect(()=>{er(L(eS,null))},[eS]);let eT=a.useMemo(()=>{let e=new Map;return i.forEach(t=>e.set(String(t.id),t)),e},[i]),eL=a.useCallback(e=>{var t,s;return null!=(s=null!=(t=K[String(e.id)])?t:e.fuelType)?s:(e=>{let t=(e.vehicleType||"").toLowerCase(),s=(e.vehicleNumber||"").toLowerCase();return["lorry","truck","bus","van","cab","pickup","tractor","tipper"].some(e=>t.includes(e)||s.includes(e))?"DIESEL":"PETROL"})(e)},[K]),eC=a.useMemo(()=>{let e=R.trim().toLowerCase();return E.filter(e=>{var t,s;return"ALL"===Q||String(null!=(s=e.vehicleId)?s:null==(t=e.vehicle)?void 0:t.id)===Q}).filter(t=>!e||"".concat(t.vehicleNumber||""," ").concat(t.vehicleType||"").toLowerCase().includes(e)).filter(e=>{if(Z){let t=e.logDate?new Date(e.logDate):e.createdAt?new Date(e.createdAt):null;if(t&&t<new Date(Z))return!1}if(ee){let t=e.logDate?new Date(e.logDate):e.createdAt?new Date(e.createdAt):null;if(t&&t>new Date(ee))return!1}return!0})},[E,Q,R,Z,ee]),eA=a.useMemo(()=>{let e=new Map;return eC.forEach(t=>{var s,l,a;let r=String(null!=(a=null!=(l=t.vehicleId)?l:null==(s=t.vehicle)?void 0:s.id)?a:""),n=eT.get(r);if(!n)return;let i=eL(n),d=e.get(r)||{vehicle:n,fuel:i,totalKm:0,totalLitres:0,totalCost:0};e.set(r,{...d,fuel:i,totalKm:d.totalKm+(t.deltaKm||0),totalLitres:d.totalLitres+(t.litres||0),totalCost:d.totalCost+(t.cost||0),lastEntry:t})}),i.forEach(t=>{let s=String(t.id);("ALL"===Q||Q===s)&&(e.has(s)||e.set(s,{vehicle:t,fuel:eL(t),totalKm:0,totalLitres:0,totalCost:0}))}),Array.from(e.values()).sort((e,t)=>(t.totalCost||0)-(e.totalCost||0))},[eC,i,Q,eT,eL]),eE=a.useMemo(()=>eC.reduce((e,t)=>(e.km+=t.deltaKm||0,e.litres+=t.litres||0,e.cost+=t.cost||0,e),{km:0,litres:0,cost:0}),[eC]),eD=a.useMemo(()=>{let e=[...eC];return e.sort((e,t)=>{let s=new Date(e.logDate||e.createdAt||"").getTime(),l=new Date(t.logDate||t.createdAt||"").getTime();return s===l?String(e.id).localeCompare(String(t.id)):s-l}),e},[eC]),eM=new Map,eO=a.useMemo(()=>eT.get(W)||i[0],[W,eT,i]),eI=eO?eL(eO):"PETROL",eP=null!=(e=null==eO?void 0:eO.fuelEfficiency)?e:null;a.useEffect(()=>{eg(null!=eP?String(eP):""),eh(eI)},[eP,eI]);let eR=eu.trim()?Number(eu):eP,eF=em||eI,eK=eP?en/eP:null,eV=null!=eK?eK*("PETROL"===eI?z.petrol:z.diesel):null,ez=Math.max(0,eo-ed),e_=eR?ez/eR:null,eU=null!=e_?e_*("PETROL"===eF?z.petrol:z.diesel):null,eq=async e=>{var t,s;if(e.preventDefault(),ev)return;let l=ep.vehicleId||W||((null==(t=i[0])?void 0:t.id)?String(i[0].id):"");if(!l)return;let a=eT.get(l);if(!a)return;let r=ej.trim().length>0,n=r?null:Number(ep.startOdo)||0,d=r?null:Number(ep.endOdo)||0,c=eL(a),o="PETROL"===c?z.petrol:z.diesel,x=ep.litres.trim()?Number(ep.litres):null;eb(!0);try{await (0,v.D)({vehicleId:l,month:Y,startOdo:n,endOdo:d,deltaKm:r?Number(ej)||0:void 0,litres:x,pricePerL:o,efficiencyUsed:null!=(s=a.fuelEfficiency)?s:void 0,fuelType:c,logDate:es||void 0}),ey(e=>({...e,startOdo:"",endOdo:"",litres:""})),ef(""),el(""),await ew()}catch(e){console.error("Failed to save fuel log",e),alert("Failed to save fuel entry. Check connection and try again.")}finally{eb(!1)}};return(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-xs font-semibold uppercase tracking-wide text-orange-700",children:"Transport"}),(0,l.jsxs)("h1",{className:"text-2xl font-bold text-orange-900 flex items-center gap-2",children:[(0,l.jsx)(r.A,{size:20})," Fuel Consumption"]}),(0,l.jsx)("p",{className:"text-sm text-gray-600",children:"Live fuel usage by vehicle, using backend data. Update prices with PIN for accurate costs."})]}),(0,l.jsx)("div",{className:"flex items-center gap-2",children:(0,l.jsx)("div",{className:"text-xs text-gray-600 bg-orange-50 border border-orange-200 rounded-lg px-3 py-2",children:"Prices editable with your PIN (per account)"})})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl p-4 shadow-sm space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-orange-900",children:"Fuel Prices"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"LKR per litre (locked by PIN)"})]}),U?(0,l.jsx)(n.A,{size:18,className:"text-orange-600"}):(0,l.jsx)(d,{size:18,className:"text-orange-600"})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Petrol (LKR/L)"}),(0,l.jsx)("input",{type:"number",value:z.petrol,onChange:e=>_(t=>({...t,petrol:Number(e.target.value)||0})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",min:0,disabled:U})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Diesel (LKR/L)"}),(0,l.jsx)("input",{type:"number",value:z.diesel,onChange:e=>_(t=>({...t,diesel:Number(e.target.value)||0})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",min:0,disabled:U})]})]}),U?(0,l.jsxs)("div",{className:"flex gap-2 items-center",children:[(0,l.jsx)("input",{type:"password",value:H,onChange:e=>J(e.target.value),placeholder:ea?"Enter PIN to unlock":"Create a PIN to unlock",className:"flex-1 rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"}),(0,l.jsx)("button",{type:"button",onClick:()=>{let e=H.trim();if(!ea)return e?(er(e),C(eS,e),q(!1),void J("")):void alert("Set a PIN to unlock.");e===ea?(q(!1),J("")):alert("Incorrect PIN")},className:"px-3 py-2 text-xs font-semibold rounded-lg bg-orange-600 text-white hover:bg-orange-700",children:ea?"Unlock":"Set & unlock"})]}):(0,l.jsxs)("div",{className:"flex gap-2",children:[(0,l.jsx)("button",{type:"button",onClick:()=>q(!0),className:"px-3 py-2 text-xs font-semibold rounded-lg border border-orange-300 text-orange-800 hover:bg-orange-50",children:"Lock prices"}),(0,l.jsx)("button",{type:"button",onClick:()=>{er(null),C(eS,null),q(!0),J("")},className:"px-3 py-2 text-xs font-semibold rounded-lg border border-red-200 text-red-700 hover:bg-red-50",children:"Reset PIN"})]})]}),(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl p-4 shadow-sm space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-orange-900",children:"Month & Filters"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Filter by month or date range."})]}),(0,l.jsx)(c.A,{className:"text-orange-600",size:18})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Select month"}),(0,l.jsx)("input",{type:"month",value:Y,onChange:e=>G(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Filter by vehicle"}),(0,l.jsxs)("select",{value:Q,onChange:e=>X(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white",children:[(0,l.jsx)("option",{value:"ALL",children:"All vehicles"}),i.map(e=>(0,l.jsxs)("option",{value:String(e.id),children:[e.vehicleNumber," • ",e.vehicleType||"Vehicle"]},e.id))]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"From date (optional)"}),(0,l.jsx)("input",{type:"date",value:Z,onChange:e=>$(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"To date (optional)"}),(0,l.jsx)("input",{type:"date",value:ee,onChange:e=>et(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Total km"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-base",children:[S(eE.km,0)," km"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Litres"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-base",children:[S(eE.litres,1)," L"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Cost"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-base",children:T(eE.cost)})]})]})]}),(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl p-4 shadow-sm space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-orange-900",children:"Odometer Calculator"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Compute km and fuel between two readings."})]}),(0,l.jsx)(o,{className:"text-orange-600",size:18})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Start (km)"}),(0,l.jsx)("input",{type:"number",value:ed,onChange:e=>ec(Number(e.target.value)||0),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"End (km)"}),(0,l.jsx)("input",{type:"number",value:eo,onChange:e=>ex(Number(e.target.value)||0),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[(0,l.jsxs)("label",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Efficiency (km/L)"}),(0,l.jsx)("input",{type:"number",value:eu,onChange:e=>eg(e.target.value),placeholder:eP?String(eP):"Enter efficiency",className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",step:"0.01",min:0}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:"Defaults to vehicle efficiency"})]}),(0,l.jsxs)("label",{className:"space-y-1",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Fuel"}),(0,l.jsxs)("select",{value:em||eI,onChange:e=>eh(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white",children:[(0,l.jsx)("option",{value:"PETROL",children:"Petrol"}),(0,l.jsx)("option",{value:"DIESEL",children:"Diesel"})]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Distance"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-base",children:[S(ez,0)," km"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Litres (calc)"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-base",children:[S(e_,2)," L"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Cost"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-base",children:T(eU)})]})]})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl p-4 shadow-sm space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-orange-900",children:"Trip Calculator"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Select a vehicle and enter distance."})]}),(0,l.jsx)(x.A,{className:"text-orange-600",size:18})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1 block",children:[(0,l.jsx)("span",{children:"Vehicle"}),(0,l.jsx)("select",{value:W,onChange:e=>{B(e.target.value),ey(t=>({...t,vehicleId:e.target.value}))},className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white",children:i.map(e=>(0,l.jsxs)("option",{value:String(e.id),children:[e.vehicleNumber," • ",e.vehicleType||"Vehicle"," • ",e.fuelType||"Fuel ?"]},e.id))})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1 block",children:[(0,l.jsx)("span",{children:"Trip distance (km)"}),(0,l.jsx)("input",{type:"number",value:en,onChange:e=>ei(Math.max(0,Number(e.target.value)||0)),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",min:0})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Fuel type"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-sm",children:eI||"—"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Efficiency"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-sm",children:eP?"".concat(S(eP)," km/L"):"Not set"})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Fuel needed"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-sm",children:[S(eK,2)," L"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Trip cost"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-sm",children:T(eV)})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:"Update efficiency in Vehicle Register for accurate numbers."}),(0,l.jsxs)("button",{type:"button",onClick:()=>t.push("/Akeel/Transport/Vehicle"),className:"inline-flex items-center gap-2 text-xs font-medium text-orange-700 hover:text-orange-900",children:["Vehicle Register ",(0,l.jsx)(u,{size:14})]})]})]}),(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl p-4 shadow-sm space-y-3",children:[(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("div",{className:"text-sm font-semibold text-orange-900",children:"Add Usage"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Odometer start/end or distance + litres (optional)."})]}),(0,l.jsx)(r.A,{className:"text-orange-600",size:18})]}),(0,l.jsxs)("form",{className:"space-y-3",onSubmit:eq,children:[(0,l.jsxs)("div",{className:"grid grid-cols-2 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Vehicle"}),(0,l.jsx)("select",{value:ep.vehicleId||W,onChange:e=>ey(t=>({...t,vehicleId:e.target.value})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 bg-white",children:i.map(e=>(0,l.jsxs)("option",{value:String(e.id),children:[e.vehicleNumber," • ",e.vehicleType||"Vehicle"," • ",e.fuelType||"Fuel ?"]},e.id))})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Month"}),(0,l.jsx)("input",{type:"month",value:Y,onChange:e=>G(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Start Odo"}),(0,l.jsx)("input",{type:"number",value:ep.startOdo,onChange:e=>ey(t=>({...t,startOdo:e.target.value})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:ej.trim().length>0})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"End Odo"}),(0,l.jsx)("input",{type:"number",value:ep.endOdo,onChange:e=>ey(t=>({...t,endOdo:e.target.value})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",disabled:ej.trim().length>0})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Litres used (optional)"}),(0,l.jsx)("input",{type:"number",value:ep.litres,onChange:e=>ey(t=>({...t,litres:e.target.value})),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",min:0,step:"0.01"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3",children:[(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Distance only (km)"}),(0,l.jsx)("input",{type:"number",value:ej,onChange:e=>ef(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500",min:0})]}),(0,l.jsxs)("label",{className:"text-xs text-gray-700 space-y-1",children:[(0,l.jsx)("span",{children:"Log date (optional)"}),(0,l.jsx)("input",{type:"date",value:es,onChange:e=>el(e.target.value),className:"w-full rounded-lg border border-orange-200 px-3 py-2 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500"})]})]}),(0,l.jsxs)("div",{className:"grid grid-cols-3 gap-3 text-xs",children:[(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Distance"}),(0,l.jsxs)("div",{className:"text-orange-900 font-semibold text-base",children:[S(Math.max(0,(Number(ep.endOdo)||0)-(Number(ep.startOdo)||0)),0)," km"]})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Fuel type"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-base",children:(()=>{let e=ep.vehicleId?eT.get(ep.vehicleId):void 0;return e?eL(e):eI})()})]}),(0,l.jsxs)("div",{className:"p-3 rounded-xl bg-orange-50 border border-orange-100",children:[(0,l.jsx)("div",{className:"text-gray-500",children:"Est. cost"}),(0,l.jsx)("div",{className:"text-orange-900 font-semibold text-base",children:(()=>{var e;let t=Number(ep.startOdo)||0,s=Math.max(0,(Number(ep.endOdo)||0)-t),l=ep.vehicleId||W,a=eT.get(l||""),r=a?eL(a):eI,n=null!=(e=null==a?void 0:a.fuelEfficiency)?e:null,i=ep.litres.trim()?Number(ep.litres):null,d=null!=i?i:n?s/n:null,c="PETROL"===r?z.petrol:z.diesel;return T(null!=d?d*c:null)})()})]})]}),(0,l.jsxs)("div",{className:"flex items-center justify-between",children:[(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:"Litres blank → auto-calc from vehicle efficiency (km/L); saved to backend."}),(0,l.jsx)("button",{type:"submit",disabled:ev,className:"px-4 py-2 rounded-lg bg-orange-600 text-white text-sm font-semibold hover:bg-orange-700 disabled:opacity-60",children:ev?"Saving…":"Add entry"})]})]})]})]}),(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl shadow-sm",children:[(0,l.jsxs)("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-3 px-4 py-3 border-b border-orange-100",children:[(0,l.jsxs)("div",{className:"flex items-center gap-2",children:[(0,l.jsxs)("div",{className:"relative",children:[(0,l.jsx)(g.A,{size:16,className:"absolute left-3 top-2.5 text-orange-500"}),(0,l.jsx)("input",{type:"text",value:R,onChange:e=>F(e.target.value),placeholder:"Search vehicle number, type, brand...",className:"pl-9 pr-3 py-2 rounded-lg border border-orange-200 text-sm focus:outline-none focus:ring-2 focus:ring-orange-500 w-72"})]}),(0,l.jsxs)("span",{className:"text-xs text-gray-500",children:["Month: ",Y||"—"]})]}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Data is stored in backend fuel logs; prices cached locally."})]}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsxs)("colgroup",{children:[(0,l.jsx)("col",{style:{width:"18%"}}),(0,l.jsx)("col",{style:{width:"12%"}}),(0,l.jsx)("col",{style:{width:"12%"}}),(0,l.jsx)("col",{style:{width:"12%"}}),(0,l.jsx)("col",{style:{width:"12%"}}),(0,l.jsx)("col",{style:{width:"12%"}}),(0,l.jsx)("col",{style:{width:"12%"}})]}),(0,l.jsx)("thead",{className:"bg-orange-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Vehicle"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Fuel"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Efficiency"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Cost / km"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Km this month"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Litres"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Cost"})]})}),(0,l.jsxs)("tbody",{className:"divide-y",children:[M||I?(0,l.jsx)("tr",{children:(0,l.jsx)(b.Td,{colSpan:7,className:"px-3 py-6 text-center text-gray-500",children:(0,l.jsxs)("span",{className:"inline-flex items-center gap-2",children:[(0,l.jsx)(m.A,{className:"animate-spin text-orange-600",size:16})," Loading…"]})})}):null,!M&&!I&&eA.map(e=>{var t;let s=String(e.vehicle.id),a="PETROL"===e.fuel?z.petrol:z.diesel,r=null!=(t=e.vehicle.fuelEfficiency)?t:null,n=r?a/r:null,i=e.vehicle.fuelType,d=void 0!==K[s];return(0,l.jsxs)("tr",{className:"hover:bg-orange-50/60 align-top",children:[(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsx)("div",{className:"font-semibold text-orange-900",children:e.vehicle.vehicleNumber||"—"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:e.vehicle.vehicleType||"—"}),(0,l.jsxs)("div",{className:"text-[11px] text-gray-500",children:[e.vehicle.brand||""," ",e.vehicle.model||""]})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsxs)("select",{value:e.fuel,onChange:e=>V(t=>({...t,[s]:e.target.value})),className:"w-full rounded-md border border-orange-200 bg-white px-2 py-1 text-xs focus:outline-none focus:ring-2 focus:ring-orange-500",children:[(0,l.jsx)("option",{value:"PETROL",children:"Petrol"}),(0,l.jsx)("option",{value:"DIESEL",children:"Diesel"})]}),(0,l.jsxs)("div",{className:"text-[11px] text-gray-500 mt-1",children:["Price: LKR ",a.toLocaleString()]}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:i?"Vehicle register: ".concat(i):"Set fuel type in Vehicle Register"}),d&&(0,l.jsx)("button",{type:"button",onClick:()=>V(e=>{let t={...e};return delete t[s],t}),className:"mt-1 text-[11px] text-orange-700 hover:text-orange-900",children:"Reset to vehicle fuel"})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsx)("div",{className:"font-semibold text-orange-900",children:r?"".concat(S(r)," km/L"):"—"}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:r?"".concat(S(100/r,2)," L / 100 km"):"Set in Vehicle Register"})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsx)("div",{className:"font-semibold text-orange-900",children:T(n)}),(0,l.jsxs)("div",{className:"text-[11px] text-gray-500",children:["With ",e.fuel.toLowerCase()," price"]})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsxs)("div",{className:"font-semibold text-orange-900",children:[S(e.totalKm,0)," km"]}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:"This month"})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsxs)("div",{className:"font-semibold text-orange-900",children:[S(e.totalLitres,1)," L"]}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:e.totalKm&&r?"Expected ".concat(S(e.totalKm/r,1)," L"):""})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsx)("div",{className:"font-semibold text-orange-900",children:T(e.totalCost)}),(0,l.jsxs)("div",{className:"text-[11px] text-gray-500",children:["Last update:"," ",e.lastEntry?new Date(e.lastEntry.createdAt||"").toLocaleString():"—"]})]})]},s)}),!M&&!I&&!eA.length&&(0,l.jsx)("tr",{children:(0,l.jsx)(b.Td,{colSpan:7,className:"px-3 py-6 text-center text-gray-500",children:"No vehicles found."})})]})]})})]}),(0,l.jsxs)("div",{className:"bg-white border border-orange-200 rounded-2xl shadow-sm",children:[(0,l.jsx)("div",{className:"px-4 py-3 border-b border-orange-100 flex items-center justify-between",children:(0,l.jsxs)("div",{children:[(0,l.jsxs)("div",{className:"text-sm font-semibold text-orange-900",children:["Entries for ",Y||"—"]}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:"Backend fuel logs. Delete hides locally; backend delete endpoint not wired yet."})]})}),(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)("table",{className:"w-full text-sm",children:[(0,l.jsx)("thead",{className:"bg-orange-50",children:(0,l.jsxs)("tr",{children:[(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Vehicle"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Start → End"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Km"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Litres"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Cost"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Fuel"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Added"}),(0,l.jsx)(b.Th,{className:"text-left px-3 py-2",children:"Cumulative"}),(0,l.jsx)(b.Th,{className:"text-center px-3 py-2",children:"Actions"})]})}),(0,l.jsxs)("tbody",{className:"divide-y",children:[0===eC.length&&(0,l.jsx)("tr",{children:(0,l.jsx)(b.Td,{colSpan:8,className:"px-3 py-6 text-center text-gray-500",children:"No entries for this selection yet."})}),eD.map(e=>{var t,s,a,r,n;let i=String(null!=(a=null!=(s=e.vehicleId)?s:null==(t=e.vehicle)?void 0:t.id)?a:""),d="".concat(i,"-").concat(e.id),c=(()=>{let t=eM.get(i)||{km:0,litres:0,cost:0},s={km:t.km+(e.deltaKm||0),litres:t.litres+(e.litres||0),cost:t.cost+(e.cost||0)};return eM.set(i,s),s})();return(0,l.jsxs)("tr",{className:"hover:bg-orange-50/50",children:[(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsx)("div",{className:"font-semibold text-orange-900",children:e.vehicleNumber||"—"}),(0,l.jsx)("div",{className:"text-xs text-gray-600",children:e.vehicleType||"—"})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[(0,l.jsxs)("div",{className:"font-semibold text-orange-900",children:[S(null!=(r=e.startOdo)?r:0,0)," → ",S(null!=(n=e.endOdo)?n:0,0)]}),(0,l.jsx)("div",{className:"text-[11px] text-gray-500",children:e.logDate?e.logDate:e.createdAt?new Date(e.createdAt).toLocaleDateString():"—"})]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[S(e.deltaKm,0)," km"]}),(0,l.jsxs)(b.Td,{className:"px-3 py-2",children:[S(e.litres,2)," L"]}),(0,l.jsx)(b.Td,{className:"px-3 py-2",children:T(e.cost)}),(0,l.jsx)(b.Td,{className:"px-3 py-2",children:e.fuelType||"—"}),(0,l.jsx)(b.Td,{className:"px-3 py-2 text-[11px] text-gray-600",children:e.createdAt?new Date(e.createdAt).toLocaleString():"—"}),(0,l.jsxs)(b.Td,{className:"px-3 py-2 text-[11px] text-gray-700",children:[(0,l.jsxs)("div",{children:["Km: ",S(c.km,0)]}),(0,l.jsxs)("div",{children:["L: ",S(c.litres,2)]}),(0,l.jsxs)("div",{children:["Cost: ",T(c.cost)]})]}),(0,l.jsx)(b.Td,{className:"px-3 py-2 text-center",children:(0,l.jsxs)("button",{type:"button",onClick:()=>{var t;return t=e.id,void D(e=>e.filter(e=>String(e.id)!==String(t)))},className:"inline-flex items-center gap-1 text-xs px-2 py-1 rounded-md text-red-600 hover:bg-red-50",children:[(0,l.jsx)(h.A,{size:14})," Hide"]})})]},d)})]})]})})]})]})}},35299:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("loader-circle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},71360:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("trash-2",[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]])},80598:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("gauge",[["path",{d:"m12 14 4-4",key:"9kzdfg"}],["path",{d:"M3.34 19a10 10 0 1 1 17.32 0",key:"19p75a"}]])},86651:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},99708:(e,t,s)=>{"use strict";s.d(t,{A:()=>l});let l=(0,s(71847).A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]])}},e=>{e.O(0,[5125,6356,8441,1255,7358],()=>e(e.s=3355)),_N_E=e.O()}]);