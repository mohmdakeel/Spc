(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4540],{8473:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>m});var r=a(95155),s=a(12115),l=a(25695),n=a(35119),c=a(29502),i=a(24947);let o=(0,a(71847).A)("tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]);var d=a(26983);let u=(e,t)=>{if(e instanceof Date)return e;if(!e)return new Date;if(e.includes("T")){let t=new Date(e);return Number.isNaN(t.getTime())?new Date:t}let a=(null!=t?t:"00:00").trim()||"00:00",r=new Date("".concat(e,"T").concat(5===a.length?"".concat(a,":00"):a));return Number.isNaN(r.getTime())?new Date:r},x=e=>e.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});function m(){let[e,t]=(0,s.useState)([]),[a,m]=(0,s.useState)(!0),[h,p]=(0,s.useState)(()=>new Date().toISOString().slice(0,10)),[g,y]=(0,s.useState)(""),[f,v]=(0,s.useState)(""),[N,j]=(0,s.useState)("");(0,s.useEffect)(()=>{(async()=>{m(!0);try{let e=(await (0,l.C)({date:h,from:f||void 0,to:N||void 0}).catch(()=>[])).map(e=>({...e,busy:(e.busy||[]).map(e=>({from:u(e.from)||new Date,to:u(e.to)||new Date,driverName:e.driverName,requestCode:e.requestCode}))}));t(e)}finally{m(!1)}})()},[h,f,N]);let w=(0,s.useMemo)(()=>{let t=g.trim().toLowerCase();return t?e.filter(e=>{let{vehicleNumber:a}=e;return[a].filter(Boolean).some(e=>String(e).toLowerCase().includes(t))}):e},[e,g]);return(0,r.jsxs)("div",{className:"space-y-4",children:[(0,r.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-3",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{className:"text-xs uppercase text-orange-700 font-semibold",children:"Availability"}),(0,r.jsx)("h1",{className:"text-lg font-bold text-orange-900",children:"Vehicles by date"}),(0,r.jsx)("p",{className:"text-sm text-gray-600",children:"See which vehicles are free or on a trip."})]}),(0,r.jsxs)("div",{className:"flex flex-wrap items-center gap-3",children:[(0,r.jsxs)("label",{className:"flex items-center gap-2 text-sm text-gray-700",children:[(0,r.jsx)(c.A,{size:16,className:"text-orange-600"}),(0,r.jsx)("input",{type:"date",value:h,onChange:e=>p(e.target.value),className:"border rounded-lg px-3 py-2 text-sm"})]}),(0,r.jsx)("input",{type:"time",value:f,onChange:e=>v(e.target.value),className:"border rounded-lg px-3 py-2 text-sm",placeholder:"From"}),(0,r.jsx)("input",{type:"time",value:N,onChange:e=>j(e.target.value),className:"border rounded-lg px-3 py-2 text-sm",placeholder:"To"}),(0,r.jsx)(n.A,{value:g,onChange:y,placeholder:"Search vehicle number, model…",className:"w-full sm:w-72"})]})]}),(0,r.jsx)("div",{className:"bg-white border border-orange-200 rounded-lg overflow-auto",children:(0,r.jsxs)("table",{className:"w-full text-[11.5px] leading-tight",children:[(0,r.jsx)("thead",{className:"bg-orange-50",children:(0,r.jsxs)("tr",{className:"text-[10px] uppercase tracking-wide text-gray-600",children:[(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"Vehicle"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"Meta"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"Availability"}),(0,r.jsx)("th",{className:"px-3 py-2 text-left",children:"Window"})]})}),(0,r.jsxs)("tbody",{className:"divide-y",children:[a?(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"Loading…"})}):null,!a&&w.map(e=>{let{vehicleNumber:t,vehicleType:a,busy:s}=e,l=(s||[]).map(e=>({...e,from:e.from instanceof Date?e.from:new Date(e.from),to:e.to instanceof Date?e.to:new Date(e.to)})),n=l.length>0;return(0,r.jsxs)("tr",{className:"hover:bg-orange-50/60",children:[(0,r.jsxs)("td",{className:"px-3 py-2",children:[(0,r.jsxs)("div",{className:"font-semibold text-orange-900 flex items-center gap-2",children:[(0,r.jsx)(i.A,{size:14,className:"text-orange-700"}),t]}),(0,r.jsx)("div",{className:"text-[10px] text-gray-600",children:a||"—"})]}),(0,r.jsx)("td",{className:"px-3 py-2 text-[10px] text-gray-700",children:(0,r.jsxs)("div",{className:"flex items-center gap-1",children:[(0,r.jsx)(o,{size:12,className:"text-orange-700"}),(0,r.jsx)("span",{children:a||"—"})]})}),(0,r.jsx)("td",{className:"px-3 py-2",children:(0,r.jsxs)("span",{className:"inline-flex items-center gap-1 rounded-full px-2 py-[3px] text-[10px] font-semibold ".concat(n?"bg-red-100 text-red-700":"bg-emerald-100 text-emerald-700"),children:[(0,r.jsx)("span",{className:"h-2 w-2 rounded-full ".concat(n?"bg-red-500":"bg-emerald-500")}),n?"Busy":"Available"]})}),(0,r.jsx)("td",{className:"px-3 py-2 text-[10.5px] text-gray-800",children:n?(0,r.jsx)("div",{className:"space-y-1",children:l.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center gap-2 text-orange-900",children:[(0,r.jsx)(d.A,{size:12,className:"text-orange-700"}),(0,r.jsxs)("span",{children:[x(e.from)," – ",x(e.to)]}),(0,r.jsxs)("span",{className:"text-gray-600",children:["Driver: ",e.driverName||"—"]}),(0,r.jsx)("span",{className:"text-gray-500",children:e.requestCode})]},t))}):(0,r.jsx)("span",{className:"text-gray-500",children:"Free all day"})})]},t)}),a||w.length?null:(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:4,className:"px-3 py-6 text-center text-gray-500",children:"No vehicles found"})})]})]})})]})}},24947:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},25695:(e,t,a)=>{"use strict";a.d(t,{C:()=>l,M:()=>s});var r=a(81242);async function s(e){let{data:t}=await r.A.get("/availability/drivers",{params:e});return(0,r.I)(t)}async function l(e){let{data:t}=await r.A.get("/availability/vehicles",{params:e});return(0,r.I)(t)}},26983:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},29502:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("calendar-clock",[["path",{d:"M16 14v2.2l1.6 1",key:"fo4ql5"}],["path",{d:"M16 2v4",key:"4m81vk"}],["path",{d:"M21 7.5V6a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h3.5",key:"1osxxc"}],["path",{d:"M3 10h5",key:"r794hk"}],["path",{d:"M8 2v4",key:"1cmpym"}],["circle",{cx:"16",cy:"16",r:"6",key:"qoo3c4"}]])},35119:(e,t,a)=>{"use strict";a.d(t,{A:()=>c});var r=a(95155),s=a(12115),l=a(86651),n=a(65229);function c(e){let{value:t,onChange:a,placeholder:c="Search…",className:i="",name:o,disabled:d=!1}=e,u=(0,s.useId)(),x=o||"incharge-search-".concat(u),m="incharge-search-".concat(u);return(0,r.jsxs)("div",{className:"relative w-full ".concat(i),children:[(0,r.jsx)("div",{className:"absolute inset-y-0 left-2 flex items-center pointer-events-none text-orange-500",children:(0,r.jsx)(l.A,{size:16})}),(0,r.jsx)("input",{type:"search",value:t,onChange:e=>a(e.target.value),placeholder:c,"aria-label":"Search",name:x,id:m,autoComplete:"new-password","data-lpignore":"true","data-1p-ignore":"true","data-form-type":"other",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,disabled:d,className:"w-full h-9 rounded-lg border border-orange-200 bg-white/90 pl-8 pr-8 text-sm text-orange-900 placeholder-orange-400/70 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-shadow ".concat(d?"opacity-70 cursor-not-allowed":"")}),t&&!d&&(0,r.jsx)("button",{type:"button",onClick:()=>a(""),className:"absolute inset-y-0 right-2 flex items-center text-orange-500 hover:text-orange-700","aria-label":"Clear search",children:(0,r.jsx)(n.A,{size:16})})]})}},65229:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("x",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]])},71847:(e,t,a)=>{"use strict";a.d(t,{A:()=>i});var r=a(12115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,a)=>a?a.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},l=function(){for(var e=arguments.length,t=Array(e),a=0;a<e;a++)t[a]=arguments[a];return t.filter((e,t,a)=>!!e&&""!==e.trim()&&a.indexOf(e)===t).join(" ").trim()};var n={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,r.forwardRef)((e,t)=>{let{color:a="currentColor",size:s=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:o="",children:d,iconNode:u,...x}=e;return(0,r.createElement)("svg",{ref:t,...n,width:s,height:s,stroke:a,strokeWidth:i?24*Number(c)/Number(s):c,className:l("lucide",o),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(x)&&{"aria-hidden":"true"},...x},[...u.map(e=>{let[t,a]=e;return(0,r.createElement)(t,a)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let a=(0,r.forwardRef)((a,n)=>{let{className:i,...o}=a;return(0,r.createElement)(c,{ref:n,iconNode:t,className:l("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...o})});return a.displayName=s(e),a}},81242:(e,t,a)=>{"use strict";a.d(t,{A:()=>i,I:()=>o});var r=a(95125),s=a(95704);let l=(s.env.NEXT_PUBLIC_TRANSPORT_BASE||"").replace(/\/$/,""),n=Math.min(Number(s.env.NEXT_PUBLIC_TRANSPORT_TIMEOUT)||1e4,15e3),c=r.A.create({baseURL:l?"".concat(l,"/api"):"/tapi",withCredentials:!0,headers:{"Content-Type":"application/json"},timeout:n}),i=c;function o(e){if(e&&"object"==typeof e&&"ok"in e){if(!1===e.ok)throw Error(e.message||"Request failed");return e.data}return e}c.interceptors.request.use(e=>{{var t,a;let r=localStorage.getItem("username")||localStorage.getItem("actor")||localStorage.getItem("employeeId")||void 0;r&&(e.headers=null!=(t=e.headers)?t:{},e.headers["X-Actor"]=r);let s=localStorage.getItem("role")||void 0;s&&(e.headers=null!=(a=e.headers)?a:{},e.headers["X-Role"]=s)}return e}),c.interceptors.response.use(e=>e,e=>{let t=null==e?void 0:e.code,a=((null==e?void 0:e.message)||"").toLowerCase();if("ECONNABORTED"===t||a.includes("timeout")){var r,s,l,n;return console.warn("Transport API timeout – returning empty response"),Promise.resolve({status:null!=(l=null==(r=e.response)?void 0:r.status)?l:0,statusText:"Request Timeout",data:null,headers:null!=(n=null==(s=e.response)?void 0:s.headers)?n:{},config:e.config,request:e.request})}return Promise.reject(e)})},86651:(e,t,a)=>{"use strict";a.d(t,{A:()=>r});let r=(0,a(71847).A)("search",[["path",{d:"m21 21-4.34-4.34",key:"14j7rj"}],["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}]])},96955:(e,t,a)=>{Promise.resolve().then(a.bind(a,8473))}},e=>{e.O(0,[5125,8441,1255,7358],()=>e(e.s=96955)),_N_E=e.O()}]);