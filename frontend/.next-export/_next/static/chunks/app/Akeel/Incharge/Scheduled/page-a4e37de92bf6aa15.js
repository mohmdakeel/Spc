(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9111],{309:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(71847).A)("printer",[["path",{d:"M6 18H4a2 2 0 0 1-2-2v-5a2 2 0 0 1 2-2h16a2 2 0 0 1 2 2v5a2 2 0 0 1-2 2h-2",key:"143wyd"}],["path",{d:"M6 9V3a1 1 0 0 1 1-1h10a1 1 0 0 1 1 1v6",key:"1itne7"}],["rect",{x:"6",y:"14",width:"12",height:"8",rx:"1",key:"1ue0tg"}]])},14875:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>j});var a=s(95155),l=s(12115),r=s(11924),n=s(7640),i=s(35119),c=s(71420),d=s(6257),o=s(12008);let x=(0,s(71847).A)("pencil",[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}],["path",{d:"m15 5 4 4",key:"1mk7zo"}]]);var p=s(309);let u=e=>e?new Date(e).toLocaleString():"-",h=e=>{var t,s,a;let l=null!=(s=null!=(t=e.appliedDate)?t:e.applied_at)?s:e.appliedOn,r=null!=(a=e.appliedTime)?a:e.applied_time;if(l&&r)return"".concat(l," ").concat(r);if(l&&e.createdAt){let t=new Date(e.createdAt).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"});return"".concat(l," ").concat(t)}return e.createdAt?u(e.createdAt):"-"},m=e=>{if(!e)return"";let t=new Date(e),s=e=>String(e).padStart(2,"0");return"".concat(t.getFullYear(),"-").concat(s(t.getMonth()+1),"-").concat(s(t.getDate()),"T").concat(s(t.getHours()),":").concat(s(t.getMinutes()))},g=e=>(null!=e?e:"").replace(/[^\d+()\-\s./;]/g,"").replace(/^[;,\s-]+/,"").replace(/\s{2,}/g," ").trim();function f(e){var t,s,a,l;if(!e)return{withOfficer:!1};if(e.travelWithOfficer||e.officerName||e.officerId||e.officerPhone)return{withOfficer:!0,name:e.officerName||void 0,id:e.officerId||void 0,phone:g(e.officerPhone)||void 0};let r="".concat(null!=(a=null==e?void 0:e.officialDescription)?a:"","\n").concat(null!=(l=null==e?void 0:e.remarks)?l:""),n=/Travelling Officer:\s*([^\(\n,]+)?(?:\s*\((?:Employee\s*ID|Emp\.?\s*ID|ID)\s*:\s*([^)]+)\))?(?:,\s*(?:Phone|Tel)\s*:\s*([^\n]+))?/i.exec(r);return n?{withOfficer:!0,name:null==(t=n[1])?void 0:t.trim(),id:null==(s=n[2])?void 0:s.trim(),phone:g(n[3])}:{withOfficer:!1}}function N(e){var t;let s=String(null!=(t=null==e?void 0:e.officialDescription)?t:"").split(/\r?\n/).filter(e=>!/travell?ing\s+officer\s*:/i.test(e)).join("\n");return(s=s.replace(/\b(?:Phone|Tel)\s*:\s*[\+\d()\-\s./;]+/gi,"").trim())||"—"}function j(){var e,t,s;let[g,j]=(0,l.useState)([]),[v,y]=(0,l.useState)(""),[b,w]=(0,l.useState)(null),[T,A]=(0,l.useState)(!1),[k,D]=(0,l.useState)(null),[S,C]=(0,l.useState)(!0),P=async()=>{C(!0);try{j(await (0,r.iv)("SCHEDULED")||[])}finally{C(!1)}};(0,l.useEffect)(()=>{P()},[]);let O=(0,l.useMemo)(()=>{let e=v.trim().toLowerCase();return e?g.filter(t=>{let s=f(t);return[t.requestCode,t.applicantName,t.employeeId,t.department,t.fromLocation,t.toLocation,t.assignedVehicleNumber,t.assignedDriverName,t.assignedDriverPhone,t.scheduledPickupAt,t.scheduledReturnAt,h(t),s.name,s.id,s.phone,N(t),t.goods].map(e=>(null!=e?e:"").toString().toLowerCase()).join(" ").includes(e)}):g},[g,v]);return(0,l.useEffect)(()=>{T&&y("")},[T]),(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsxs)("div",{className:"flex flex-wrap items-center justify-between gap-2 mb-2",children:[(0,a.jsx)("h1",{className:"text-[14px] md:text-lg font-bold text-orange-900",children:"Scheduled Assignments"}),(0,a.jsx)(i.A,{value:v,onChange:y,placeholder:"Search code, applicant, vehicle, driver…",className:"w-full sm:w-72",disabled:T},T?"modal-open":"modal-closed")]}),(0,a.jsx)("div",{className:"bg-white rounded-lg border border-orange-200",children:(0,a.jsx)("div",{className:"overflow-x-auto overflow-y-hidden    [&::-webkit-scrollbar]:h-2    [&::-webkit-scrollbar-thumb]:bg-orange-300    [&::-webkit-scrollbar-track]:bg-transparent    [scrollbar-width:thin]",children:(0,a.jsxs)("table",{className:"min-w-full table-fixed text-[10px] leading-[1.15]",children:[(0,a.jsxs)("colgroup",{children:[(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-36"}),(0,a.jsx)("col",{className:"w-[18rem]"}),(0,a.jsx)("col",{className:"w-28"})]}),(0,a.jsx)("thead",{className:"bg-orange-50",children:(0,a.jsxs)("tr",{className:"text-[9.5px]",children:[(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"RQ ID / Applied"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Applicant / Dept"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Vehicle / Driver"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Schedule"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Route"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Officer"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-left",children:"Purpose / Goods"}),(0,a.jsx)(n.Th,{className:"px-2 py-1 text-center",children:"Actions"})]})}),(0,a.jsxs)("tbody",{className:"divide-y",children:[S&&(0,a.jsx)("tr",{children:(0,a.jsx)(n.Td,{colSpan:8,className:"px-2 py-6 text-center text-gray-500",children:"Loading…"})}),!S&&O.map(e=>{let t=f(e);return(0,a.jsxs)("tr",{className:"align-top hover:bg-orange-50/40",children:[(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsx)("div",{className:"font-semibold text-orange-900 truncate",title:e.requestCode,children:e.requestCode}),(0,a.jsx)("div",{className:"text-[9px] text-gray-600 truncate",title:h(e),children:h(e)})]}),(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsxs)("div",{className:"truncate",title:"".concat(e.applicantName," (").concat(e.employeeId,")"),children:[(0,a.jsx)("span",{className:"font-medium text-orange-900",children:e.applicantName}),(0,a.jsxs)("span",{className:"text-[9px] text-gray-600",children:[" (",e.employeeId,")"]})]}),(0,a.jsx)("div",{className:"text-[9px] text-gray-700 truncate",children:e.department||"-"})]}),(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsx)("div",{className:"font-medium truncate",children:e.assignedVehicleNumber||"—"}),(0,a.jsxs)("div",{className:"text-[9px] text-gray-700 truncate",children:[e.assignedDriverName||"—"," ",e.assignedDriverPhone?(0,a.jsxs)("span",{className:"text-[9px] text-gray-600",children:["(",e.assignedDriverPhone,")"]}):null]})]}),(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsxs)("div",{className:"truncate",children:["P: ",u(e.scheduledPickupAt)]}),(0,a.jsxs)("div",{className:"text-[9px] text-gray-600 truncate",children:["R: ",u(e.scheduledReturnAt)]})]}),(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsxs)("div",{className:"truncate",children:[e.fromLocation," → ",e.toLocation]}),(0,a.jsxs)("div",{className:"text-[9px] text-gray-600",children:[(0,a.jsx)("span",{className:"font-mono",children:e.dateOfTravel})," ",(0,a.jsx)("span",{className:"font-mono",children:e.timeFrom}),"–",(0,a.jsx)("span",{className:"font-mono",children:e.timeTo})," ",e.overnight?"(overnight)":""]})]}),(0,a.jsx)(n.Td,{className:"px-2 py-1",children:t.withOfficer?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("div",{children:[t.name||"—",t.id?(0,a.jsxs)("span",{className:"text-[9px] text-gray-600",children:[" (",t.id,")"]}):null]}),t.phone?(0,a.jsx)("div",{className:"text-[9px] text-gray-700",children:t.phone}):null]}):"—"}),(0,a.jsxs)(n.Td,{className:"px-2 py-1",children:[(0,a.jsx)("div",{className:"text-orange-900 break-words",children:N(e)}),(0,a.jsx)("div",{className:"text-[9px] text-orange-700/80",children:e.goods||"—"})]}),(0,a.jsx)(n.Td,{className:"px-2 py-1 text-center",children:(0,a.jsxs)("div",{className:"inline-flex items-center gap-1",children:[(0,a.jsxs)("button",{className:"px-2.5 py-[6px] rounded bg-blue-600 text-white hover:bg-blue-700 text-[10px] flex items-center gap-1",onClick:()=>{let t=(e=>{let t=e.scheduledPickupAt||(e.dateOfTravel&&e.timeFrom?"".concat(e.dateOfTravel,"T").concat(e.timeFrom):null);if(!t)return null;let s=new Date(t);return Number.isNaN(s.getTime())?null:(s.getTime()-Date.now())/36e5<24?"Trip starts in <24 hours; edits are locked. Please notify the applicant for changes.":null})(e);t&&o.oR.warn(t),D(t),w(e),A(!0)},title:"Edit assignment",children:[(0,a.jsx)(x,{size:12})," Edit"]}),(0,a.jsxs)("button",{className:"px-2.5 py-[6px] rounded bg-green-600 text-white hover:bg-green-700 text-[10px] flex items-center gap-1",onClick:()=>(0,d.du)(e),title:"Print usage slip",children:[(0,a.jsx)(p.A,{size:12})," Slip"]})]})})]},e.id)}),!S&&!O.length&&(0,a.jsx)("tr",{children:(0,a.jsx)(n.Td,{colSpan:8,className:"px-2 py-6 text-center text-gray-500",children:"No scheduled requests"})})]})]})})}),b&&(0,a.jsx)(c.A,{open:T,requestId:b.id,defaultValues:{vehicleNumber:null!=(e=b.assignedVehicleNumber)?e:"",driverName:null!=(t=b.assignedDriverName)?t:"",driverPhone:null!=(s=b.assignedDriverPhone)?s:"",pickupAt:m(b.scheduledPickupAt),expectedReturnAt:m(b.scheduledReturnAt),instructions:b.instructions||""},lockedReason:k,onAssigned:()=>{o.oR.success("Assignment updated"),w(null),A(!1),P()},onClose:()=>{A(!1),w(null),D(null)}})]})}},35119:(e,t,s)=>{"use strict";s.d(t,{A:()=>i});var a=s(95155),l=s(12115),r=s(86651),n=s(65229);function i(e){let{value:t,onChange:s,placeholder:i="Search…",className:c="",name:d,disabled:o=!1}=e,x=(0,l.useId)(),p=d||"incharge-search-".concat(x),u="incharge-search-".concat(x);return(0,a.jsxs)("div",{className:"relative w-full ".concat(c),children:[(0,a.jsx)("div",{className:"absolute inset-y-0 left-2 flex items-center pointer-events-none text-orange-500",children:(0,a.jsx)(r.A,{size:16})}),(0,a.jsx)("input",{type:"search",value:t,onChange:e=>s(e.target.value),placeholder:i,"aria-label":"Search",name:p,id:u,autoComplete:"new-password","data-lpignore":"true","data-1p-ignore":"true","data-form-type":"other",autoCorrect:"off",autoCapitalize:"off",spellCheck:!1,disabled:o,className:"w-full h-9 rounded-lg border border-orange-200 bg-white/90 pl-8 pr-8 text-sm text-orange-900 placeholder-orange-400/70 focus:outline-none focus:ring-2 focus:ring-orange-400 focus:border-orange-400 transition-shadow ".concat(o?"opacity-70 cursor-not-allowed":"")}),t&&!o&&(0,a.jsx)("button",{type:"button",onClick:()=>s(""),className:"absolute inset-y-0 right-2 flex items-center text-orange-500 hover:text-orange-700","aria-label":"Clear search",children:(0,a.jsx)(n.A,{size:16})})]})}},69536:(e,t,s)=>{Promise.resolve().then(s.bind(s,14875))}},e=>{e.O(0,[5125,970,6737,1420,8441,1255,7358],()=>e(e.s=69536)),_N_E=e.O()}]);