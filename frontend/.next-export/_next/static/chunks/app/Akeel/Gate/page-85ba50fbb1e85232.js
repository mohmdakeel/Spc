(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2043],{10436:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>o});var s=r(95155),a=r(12115),n=r(11924),l=r(26983),c=r(24947);let i=e=>e?new Date(e).toLocaleString():"-";function o(){let[e,t]=(0,a.useState)([]),[r,o]=(0,a.useState)([]),[u,d]=(0,a.useState)(!0);(0,a.useEffect)(()=>{(async()=>{d(!0);try{let[e,r]=await Promise.all([(0,n.iv)("SCHEDULED"),(0,n.iv)("DISPATCHED")]);t(e||[]),o(r||[])}finally{d(!1)}})()},[]);let m=(0,a.useMemo)(()=>[{label:"Scheduled",val:e.length,icon:(0,s.jsx)(l.A,{size:18,className:"text-blue-600"})},{label:"On Trip (Dispatched)",val:r.length,icon:(0,s.jsx)(c.A,{size:18,className:"text-emerald-600"})}],[e,r]);return(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsx)("h1",{className:"text-lg font-bold text-orange-900",children:"Gate Security Dashboard"}),(0,s.jsx)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4",children:m.map(e=>(0,s.jsxs)("div",{className:"rounded-lg border border-orange-200 bg-white p-5 shadow-sm",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between",children:[(0,s.jsx)("div",{className:"text-sm text-orange-700",children:e.label}),e.icon]}),(0,s.jsx)("div",{className:"text-3xl font-bold text-orange-900 mt-1",children:u?"—":e.val})]},e.label))}),(0,s.jsxs)("section",{className:"rounded-lg border border-orange-200 bg-white overflow-hidden",children:[(0,s.jsxs)("div",{className:"flex items-center justify-between px-4 py-3 border-b border-orange-100",children:[(0,s.jsx)("h2",{className:"text-md font-semibold text-orange-900",children:"Scheduled Next"}),(0,s.jsx)("p",{className:"text-xs text-gray-500",children:"Upcoming pickups and returns"})]}),(0,s.jsxs)("table",{className:"w-full text-sm",children:[(0,s.jsx)("thead",{className:"bg-orange-50",children:(0,s.jsxs)("tr",{children:[(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Code"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Vehicle"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Driver"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Pickup"}),(0,s.jsx)("th",{className:"px-4 py-2 text-left",children:"Return"})]})}),(0,s.jsxs)("tbody",{className:"divide-y",children:[e.slice(0,8).map(e=>(0,s.jsxs)("tr",{children:[(0,s.jsx)("td",{className:"px-4 py-2",children:e.requestCode}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.assignedVehicleNumber||"-"}),(0,s.jsx)("td",{className:"px-4 py-2",children:e.assignedDriverName||"-"}),(0,s.jsx)("td",{className:"px-4 py-2",children:i(e.scheduledPickupAt)}),(0,s.jsx)("td",{className:"px-4 py-2",children:i(e.scheduledReturnAt)})]},e.id)),!u&&!e.length&&(0,s.jsx)("tr",{children:(0,s.jsx)("td",{colSpan:5,className:"px-4 py-6 text-center text-gray-500",children:"None"})})]})]})]})]})}},11924:(e,t,r)=>{"use strict";r.d(t,{Cd:()=>g,Lh:()=>o,bB:()=>a,bk:()=>u,cK:()=>l,iq:()=>i,iv:()=>c,kM:()=>h,lm:()=>n,qd:()=>x,rg:()=>m,rr:()=>d,uK:()=>p});var s=r(81242);async function a(e){let{data:t}=await s.A.post("/usage-requests",e);return(0,s.I)(t)}async function n(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,{data:a}=await s.A.get("/usage-requests/my",{params:{employeeId:e,page:t,size:r}});return(0,s.I)(a)}async function l(){try{let{data:e}=await s.A.get("/usage-requests/all");return(0,s.I)(e)}catch(r){let{data:e}=await s.A.get("/usage-requests"),t=(0,s.I)(e);if(Array.isArray(t))return t;if((null==t?void 0:t.content)&&Array.isArray(t.content))return t.content;return t}}async function c(e){try{let{data:t}=await s.A.get("/usage-requests/status/".concat(e));return(0,s.I)(t)}catch(t){return console.warn("Failed to load usage requests by status",e,t),[]}}async function i(e){let{data:t}=await s.A.get("/usage-requests/".concat(e));return(0,s.I)(t)}let o=async(e,t)=>(0,s.I)((await s.A.post("/usage-requests/".concat(e,"/hod/approve"),{remarks:t})).data),u=async(e,t)=>(0,s.I)((await s.A.post("/usage-requests/".concat(e,"/hod/reject"),{remarks:t})).data),d=async(e,t)=>(0,s.I)((await s.A.post("/usage-requests/".concat(e,"/mgmt/approve"),{remarks:t})).data),m=async(e,t)=>(0,s.I)((await s.A.post("/usage-requests/".concat(e,"/mgmt/reject"),{remarks:t})).data);async function p(e,t){let r={...t,pickupAt:t.pickupAt instanceof Date?t.pickupAt.toISOString():t.pickupAt,expectedReturnAt:t.expectedReturnAt instanceof Date?t.expectedReturnAt.toISOString():t.expectedReturnAt},{data:a}=await s.A.post("/usage-requests/".concat(e,"/assign"),r);return(0,s.I)(a)}async function h(e,t){let r={};"number"==typeof t.exitOdometer&&(r.exitOdometer=t.exitOdometer),"number"==typeof t.odometerStartKm&&null==r.exitOdometer&&(r.exitOdometer=t.odometerStartKm);let a=[];t.remarks&&a.push({type:"note",value:String(t.remarks)}),Array.isArray(t.exitManifest)&&t.exitManifest.length&&a.push(...t.exitManifest),a.length&&(r.exitManifest=a);let{data:n}=await s.A.post("/usage-requests/".concat(e,"/gate/exit"),r);return(0,s.I)(n)}async function g(e,t){let r={};"number"==typeof t.entryOdometer&&(r.entryOdometer=t.entryOdometer),"number"==typeof t.odometerEndKm&&null==r.entryOdometer&&(r.entryOdometer=t.odometerEndKm);let a=[];t.remarks&&a.push({type:"note",value:String(t.remarks)}),Array.isArray(t.entryManifest)&&t.entryManifest.length&&a.push(...t.entryManifest),a.length&&(r.entryManifest=a);let{data:n}=await s.A.post("/usage-requests/".concat(e,"/gate/entry"),r);return(0,s.I)(n)}async function x(){let{data:e}=await s.A.get("/usage-requests/metrics");return(0,s.I)(e)}},24947:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},26983:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(71847).A)("clock",[["path",{d:"M12 6v6l4 2",key:"mmk7yg"}],["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]])},54849:(e,t,r)=>{Promise.resolve().then(r.bind(r,10436))},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var s=r(12115);let a=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let c=(0,s.forwardRef)((e,t)=>{let{color:r="currentColor",size:a=24,strokeWidth:c=2,absoluteStrokeWidth:i,className:o="",children:u,iconNode:d,...m}=e;return(0,s.createElement)("svg",{ref:t,...l,width:a,height:a,stroke:r,strokeWidth:i?24*Number(c)/Number(a):c,className:n("lucide",o),...!u&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(m)&&{"aria-hidden":"true"},...m},[...d.map(e=>{let[t,r]=e;return(0,s.createElement)(t,r)}),...Array.isArray(u)?u:[u]])}),i=(e,t)=>{let r=(0,s.forwardRef)((r,l)=>{let{className:i,...o}=r;return(0,s.createElement)(c,{ref:l,iconNode:t,className:n("lucide-".concat(a(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...o})});return r.displayName=a(e),r}},81242:(e,t,r)=>{"use strict";r.d(t,{A:()=>i,I:()=>o});var s=r(95125),a=r(95704);let n=(a.env.NEXT_PUBLIC_TRANSPORT_BASE||"").replace(/\/$/,""),l=Math.min(Number(a.env.NEXT_PUBLIC_TRANSPORT_TIMEOUT)||1e4,15e3),c=s.A.create({baseURL:n?"".concat(n,"/api"):"/tapi",withCredentials:!0,headers:{"Content-Type":"application/json"},timeout:l}),i=c;function o(e){if(e&&"object"==typeof e&&"ok"in e){if(!1===e.ok)throw Error(e.message||"Request failed");return e.data}return e}c.interceptors.request.use(e=>{{var t,r;let s=localStorage.getItem("username")||localStorage.getItem("actor")||localStorage.getItem("employeeId")||void 0;s&&(e.headers=null!=(t=e.headers)?t:{},e.headers["X-Actor"]=s);let a=localStorage.getItem("role")||void 0;a&&(e.headers=null!=(r=e.headers)?r:{},e.headers["X-Role"]=a)}return e}),c.interceptors.response.use(e=>e,e=>{let t=null==e?void 0:e.code,r=((null==e?void 0:e.message)||"").toLowerCase();if("ECONNABORTED"===t||r.includes("timeout")){var s,a,n,l;return console.warn("Transport API timeout – returning empty response"),Promise.resolve({status:null!=(n=null==(s=e.response)?void 0:s.status)?n:0,statusText:"Request Timeout",data:null,headers:null!=(l=null==(a=e.response)?void 0:a.headers)?l:{},config:e.config,request:e.request})}return Promise.reject(e)})}},e=>{e.O(0,[5125,8441,1255,7358],()=>e(e.s=54849)),_N_E=e.O()}]);