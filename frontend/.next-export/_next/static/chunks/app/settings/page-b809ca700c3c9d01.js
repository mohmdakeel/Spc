(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4662],{5017:(e,s,r)=>{Promise.resolve().then(r.bind(r,82417))},36710:(e,s,r)=>{"use strict";r.d(s,{A:()=>f});var a=r(95155),t=r(52619),n=r.n(t),l=r(15239),o=r(20063),d=r(65993),i=r(91169),c=r(20508),m=r(17910),x=r(15870),g=r(54485),h=r(80534),u=r(50069),p=r(84926),b=r(68209),N=r(12115);let j=[{text:"Dashboard",icon:d.A,path:"/dashboard",roles:["ADMIN","AUTH_ADMIN","HRD","HOD","GM","CHAIRMAN","TRANSPORT_ADMIN","TRANSPORT","VEHICLE_INCHARGE"],perm:"READ"},{text:"Employees",icon:i.A,path:"/employees",roles:["ADMIN","HRD","HOD","GM","TRANSPORT_ADMIN"],perm:"READ"},{text:"Users",icon:c.A,path:"/users",roles:["ADMIN","AUTH_ADMIN","HRD"],perm:"READ"},{text:"Roles",icon:m.A,path:"/roles",roles:["ADMIN"],perm:"READ"},{text:"Permissions",icon:x.A,path:"/permissions",roles:["ADMIN"],perm:"READ"},{text:"History",icon:g.A,path:"/history",roles:["ADMIN","AUTH_ADMIN","HRD","HOD","GM","TRANSPORT_ADMIN"],perm:"READ"},{text:"Reports",icon:h.A,path:"/reports",roles:["ADMIN","HRD","HOD","GM","CHAIRMAN"],perm:"READ"}];function f(e){let{user:s,isOpen:r,onClose:t}=e,d=(0,o.usePathname)()||"";(0,o.useRouter)();let[i,c]=(0,N.useState)(!1),m=j.filter(e=>{var r,a,t;return(!(r=e.roles)||0===r.length||r.some(e=>{var r;return null==(r=s.roles)?void 0:r.includes(e)}))&&(!(a=e.perm)||(null==(t=s.permissions)?void 0:t.includes(a)))}),g=async()=>{try{await (0,b.ri)()}finally{window.location.href="/login"}};return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsxs)("aside",{className:"hod-sidebar w-64 min-w-64 shrink-0 h-screen sticky top-0 bg-orange-100 p-4 border-r border-orange-200 flex flex-col transition-transform duration-300 ".concat(r?"translate-x-0":"-translate-x-full"," md:translate-x-0"),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-6",children:[(0,a.jsx)("div",{className:"w-12 h-12 rounded-2xl border border-orange-200 bg-white/80 flex items-center justify-center shadow-sm",children:(0,a.jsx)(l.default,{src:"/spclogopic.png",alt:"State Printing Corporation logo",width:36,height:36,className:"object-contain",priority:!0})}),(0,a.jsxs)("div",{className:"min-w-0",children:[(0,a.jsx)("h1",{className:"font-bold text-sm text-orange-900 leading-tight truncate",children:"State Printing Corporation"}),(0,a.jsx)("p",{className:"text-xs text-orange-700/70 truncate",children:"Auth Service Control"})]})]}),(0,a.jsx)("nav",{className:"space-y-1 flex-1",children:m.map(e=>{let s,r=e.icon,l=d===(s=e.path)||d.startsWith("".concat(s,"/"));return(0,a.jsxs)(n(),{href:e.path,onClick:t,className:"hod-sidebar__item ".concat(l?"is-active":""),"aria-current":l?"page":void 0,children:[(0,a.jsx)(r,{size:18}),(0,a.jsx)("span",{className:"truncate",children:e.text})]},e.text)})}),(0,a.jsxs)("div",{className:"pt-4 mt-6 border-t border-orange-200 space-y-2",children:[(0,a.jsxs)(n(),{href:"/profile",onClick:t,className:"hod-sidebar__link",children:[(0,a.jsx)(u.A,{size:18}),(0,a.jsx)("span",{children:"Profile"})]}),(0,a.jsxs)(n(),{href:"/settings",onClick:t,className:"hod-sidebar__link",children:[(0,a.jsx)(x.A,{size:18}),(0,a.jsx)("span",{children:"Settings"})]}),(0,a.jsxs)("button",{onClick:()=>c(!0),className:"hod-sidebar__danger",children:[(0,a.jsx)(p.A,{size:18}),(0,a.jsx)("span",{children:"Logout"})]})]})]}),i&&(0,a.jsx)("div",{className:"fixed inset-0 bg-black/40 z-50 grid place-items-center p-4",onClick:()=>c(!1),children:(0,a.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-sm overflow-hidden border border-orange-200",onClick:e=>e.stopPropagation(),children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 px-4 py-3 border-b bg-orange-50",children:[(0,a.jsx)("div",{className:"w-10 h-10 rounded-lg border border-orange-200 bg-white/80 flex items-center justify-center overflow-hidden",children:(0,a.jsx)(l.default,{src:"/spclogopic.png",alt:"SPC",width:32,height:32,className:"object-contain"})}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-semibold text-orange-900",children:"Logout"}),(0,a.jsx)("p",{className:"text-xs text-orange-700/80",children:"Are you sure you want to logout?"})]})]}),(0,a.jsxs)("div",{className:"px-4 py-3 flex justify-end gap-2 bg-white",children:[(0,a.jsx)("button",{className:"px-4 py-2 rounded border border-orange-200 text-orange-700 hover:bg-orange-50",onClick:()=>c(!1),children:"Cancel"}),(0,a.jsx)("button",{className:"px-4 py-2 rounded bg-orange-600 text-white hover:bg-orange-700",onClick:()=>{c(!1),g()},children:"Yes, logout"})]})]})})]})}},82417:(e,s,r)=>{"use strict";r.r(s),r.d(s,{default:()=>v});var a=r(95155),t=r(12115),n=r(43566),l=r(36710),o=r(4259),d=r(37621),i=r(16174),c=r(15870),m=r(42529),x=r(78874),g=r(89470),h=r(55867),u=r(70532),p=r(57828),b=r(5370),N=r(23327),j=r(37494),f=r(59427);function v(){var e,s,r,v,w,y,A;let{user:D,refresh:R}=(0,o.A)(),[k,C]=(0,t.useState)(!1),[P,M]=(0,t.useState)(""),[S,_]=(0,t.useState)(""),[H,I]=(0,t.useState)(!1),[T,E]=(0,t.useState)(!1),O=null!=(A=null!=(y=null==D?void 0:D.username)?y:null==D?void 0:D.email)?A:"",[F,U]=(0,t.useState)(""),[z,L]=(0,t.useState)(""),{theme:G,setTheme:Y}=(0,i.D)();function V(e){U(e),setTimeout(()=>U(""),3e3)}function W(e){L(e),setTimeout(()=>L(""),5e3)}let q=async e=>{if(null==e||e.preventDefault(),!P||!S)return void W("Please fill both fields");try{E(!0),await d.A.post("/auth/change-password",{oldPassword:P,newPassword:S}),await (null==R?void 0:R()),M(""),_(""),V("Password updated successfully")}catch(e){var s,r;W("object"==typeof e&&null!==e&&"response"in e&&(null==(r=e.response)||null==(s=r.data)?void 0:s.message)?e.response.data.message:"Failed to change password")}finally{E(!1)}},B=e=>{Y(e),V("Appearance set to ".concat("dark"===e?"Dark":"Light"," mode."))};return D?(0,a.jsxs)("div",{className:"auth-shell",children:[(0,a.jsx)(l.A,{user:D,isOpen:k,onClose:()=>C(!1)}),(0,a.jsxs)("div",{className:"auth-shell__main overflow-hidden",children:[(0,a.jsx)(n.A,{user:D}),(0,a.jsxs)("main",{className:"auth-shell__content",children:[(0,a.jsxs)("div",{className:"mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center gap-3 mb-2",children:[(0,a.jsx)(c.A,{className:"w-8 h-8 text-orange-600"}),(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Settings"})]}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your account and system configuration"})]}),F&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-green-50 border border-green-200 rounded-lg flex items-center",children:[(0,a.jsx)(m.A,{className:"mr-2 text-green-600"}),(0,a.jsx)("span",{className:"text-green-800",children:F})]}),z&&(0,a.jsxs)("div",{className:"mb-6 p-4 bg-red-50 border border-red-200 rounded-lg flex items-center",children:[(0,a.jsx)(x.A,{className:"mr-2 text-red-600"}),(0,a.jsx)("span",{className:"text-red-800",children:z})]}),(0,a.jsx)("div",{className:"space-y-8",children:(0,a.jsxs)("div",{className:"w-full space-y-6",children:[(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-orange-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-orange-200 bg-orange-50",children:(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(g.A,{className:"w-5 h-5 text-orange-600"}),"My Account"]})}),(0,a.jsxs)("div",{className:"p-6 space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Username"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:D.username})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Full Name"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:D.fullName||"—"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Email"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:D.email||"—"})]}),(0,a.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-orange-700 mb-1",children:"Department"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:D.department||"—"})]})]}),(0,a.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,a.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-5 h-5 text-orange-600"}),"Change Password"]}),(0,a.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,a.jsx)("input",{type:"text",name:"username",autoComplete:"username",value:O,onChange:()=>{},className:"sr-only",inputMode:"text"}),(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Current Password"}),(0,a.jsx)("input",{id:"currentPassword",name:"currentPassword",type:H?"text":"password",value:P,onChange:e=>M(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter current password",autoComplete:"current-password"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,a.jsxs)("div",{className:"flex gap-2",children:[(0,a.jsx)("input",{id:"newPassword",name:"newPassword",type:H?"text":"password",value:S,onChange:e=>_(e.target.value),className:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500",placeholder:"Enter new password",autoComplete:"new-password"}),(0,a.jsx)("button",{type:"button",onClick:()=>I(e=>!e),className:"px-3 border border-gray-300 rounded-lg bg-gray-50 hover:bg-gray-100 transition-colors",title:H?"Hide passwords":"Show passwords","aria-label":H?"Hide passwords":"Show passwords",children:H?(0,a.jsx)(u.A,{className:"w-5 h-5 text-gray-600"}):(0,a.jsx)(p.A,{className:"w-5 h-5 text-gray-600"})})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500 mt-2",children:["• At least 8 characters",(0,a.jsx)("br",{}),"• Mix of letters and numbers"]})]})]}),(0,a.jsx)("button",{type:"submit",disabled:T,className:"flex items-center px-6 py-3 bg-orange-600 text-white rounded-lg hover:bg-orange-700 disabled:bg-orange-400 disabled:cursor-not-allowed transition-colors font-medium",children:T?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Updating Password..."]}):(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(b.A,{className:"w-4 h-4 mr-2"}),"Update Password"]})})]})]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-orange-200 overflow-hidden",children:[(0,a.jsx)("div",{className:"p-6 border-b border-orange-200 bg-orange-50",children:(0,a.jsxs)("h2",{className:"text-xl font-bold text-gray-900 flex items-center gap-2",children:[(0,a.jsx)(N.A,{className:"w-5 h-5 text-orange-600"}),"System Information"]})}),(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4",children:[(0,a.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-blue-700 mb-1",children:"Your Roles"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:(D.roles||[]).length>0?(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:(D.roles||[]).map(e=>(0,a.jsx)("span",{className:"bg-blue-100 text-blue-800 px-2 py-1 rounded text-xs font-medium",children:e},e))}):"—"})]}),(0,a.jsxs)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-green-700 mb-1",children:"Your Permissions"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:(D.permissions||[]).length>0?(0,a.jsx)("div",{className:"flex flex-wrap gap-1",children:(D.permissions||[]).map(e=>(0,a.jsx)("span",{className:"bg-green-100 text-green-800 px-2 py-1 rounded text-xs font-medium",children:e},e))}):"—"})]}),(0,a.jsxs)("div",{className:"bg-purple-50 border border-purple-200 rounded-lg p-4",children:[(0,a.jsx)("div",{className:"text-sm font-medium text-purple-700 mb-1",children:"Access Scope"}),(0,a.jsx)("div",{className:"text-gray-900 font-medium",children:(null==(e=D.roles)?void 0:e.includes("ADMIN"))?"Full Admin":(null==(s=D.roles)?void 0:s.includes("TRANSPORT_ADMIN"))?"Transport Admin":(null==(r=D.roles)?void 0:r.includes("TRANSPORT"))?"Transport Staff":(null==(v=D.roles)?void 0:v.includes("HR"))||(null==(w=D.roles)?void 0:w.includes("HRD"))?"HR Department":"Standard User"})]})]}),(0,a.jsxs)("div",{className:"text-sm text-gray-500 bg-gray-50 border border-gray-200 rounded-lg p-3",children:[(0,a.jsx)(N.A,{className:"w-4 h-4 inline mr-1"}),"This information comes from your authentication session and backend permissions. Contact ADMIN if anything appears incorrect."]})]})]}),(0,a.jsxs)("div",{className:"bg-white rounded-2xl shadow-lg border border-orange-200 overflow-hidden",children:[(0,a.jsxs)("div",{className:"p-6 border-b border-orange-200 bg-orange-50 flex items-center gap-2",children:["dark"===G?(0,a.jsx)(j.A,{className:"w-5 h-5 text-orange-600"}):(0,a.jsx)(f.A,{className:"w-5 h-5 text-orange-600"}),(0,a.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Appearance"})]}),(0,a.jsxs)("div",{className:"p-6 space-y-4",children:[(0,a.jsx)("p",{className:"text-sm text-gray-600",children:"Switch between light and dark modes for the entire workspace."}),(0,a.jsxs)("div",{className:"flex flex-col sm:flex-row gap-3",children:[(0,a.jsx)("button",{type:"button",onClick:()=>B("light"),className:"flex-1 rounded-lg border px-4 py-3 text-sm font-semibold transition ".concat("light"===G?"bg-orange-600 text-white border-orange-600 shadow":"border-orange-200 text-orange-800 hover:bg-orange-50"),children:"Light Mode"}),(0,a.jsx)("button",{type:"button",onClick:()=>B("dark"),className:"flex-1 rounded-lg border px-4 py-3 text-sm font-semibold transition ".concat("dark"===G?"bg-orange-600 text-white border-orange-600 shadow":"border-orange-200 text-orange-800 hover:bg-orange-50"),children:"Dark Mode"})]}),(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["Preference is stored locally as ",(0,a.jsx)("code",{children:"workspace-theme"}),"."]})]})]})]})}),(0,a.jsx)("button",{onClick:()=>C(!0),className:"md:hidden fixed bottom-6 right-6 w-14 h-14 bg-orange-600 text-white rounded-full shadow-lg hover:bg-orange-700 transition-all flex items-center justify-center z-40",children:(0,a.jsx)("span",{className:"text-lg font-bold",children:"☰"})})]})]})]}):(0,a.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-orange-100 flex items-center justify-center",children:(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("div",{className:"w-16 h-16 border-4 border-orange-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Loading..."})]})})}}},e=>{e.O(0,[5125,6394,2619,8617,3566,8441,1255,7358],()=>e(e.s=5017)),_N_E=e.O()}]);