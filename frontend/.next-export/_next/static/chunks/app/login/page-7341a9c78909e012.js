(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4520],{12219:(e,t,r)=>{Promise.resolve().then(r.bind(r,70017))},17910:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])},24947:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("car",[["path",{d:"M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2",key:"5owen"}],["circle",{cx:"7",cy:"17",r:"2",key:"u2ysq9"}],["path",{d:"M9 17h6",key:"r8uit2"}],["circle",{cx:"17",cy:"17",r:"2",key:"axvx0g"}]])},33801:(e,t,r)=>{"use strict";function a(e){if(!e||!e.roles)return"/login";let t=e.roles.map(e=>e.toUpperCase()),r=t.includes("ADMIN");return t.includes("HOD")&&!r?"/Akeel/Hod":!r&&["HRD","GM","CHAIRMAN"].some(e=>t.includes(e))?"/Akeel/Management":!r&&t.includes("GATE_SECURITY")?"/Akeel/Gate":!r&&t.includes("VEHICLE_INCHARGE")?"/Akeel/Incharge":!r&&t.includes("STAFF")?"/Akeel/Applicant":t.includes("ADMIN")||s(e,"auth")&&s(e,"transport")?"/maindashboard":s(e,"transport")?"/Akeel/Transport":s(e,"auth")?"/dashboard":"/maindashboard"}function s(e,t){if(!(null==e?void 0:e.roles))return!1;let r=e.roles.map(e=>e.toUpperCase());if("auth"===t){let e=["ADMIN","HR","HRD","HOD","GM","CHAIRMAN","STAFF"];return r.some(t=>e.includes(t))}if("transport"===t){let e=["ADMIN","TRANSPORT_ADMIN","TRANSPORT","VEHICLE_INCHARGE","GATE_SECURITY"];return r.some(t=>e.includes(t))}return!1}r.d(t,{Gv:()=>a,oJ:()=>s})},37621:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(95125),s=r(95704);let n=(s.env.NEXT_PUBLIC_AUTH_BASE||"").replace(/\/$/,""),l=Math.min(Number(s.env.NEXT_PUBLIC_API_TIMEOUT)||1e4,15e3),o=a.A.create({baseURL:n?"".concat(n,"/api"):"/aapi",withCredentials:!0,headers:{"Content-Type":"application/json"},timeout:l});o.interceptors.request.use(e=>e,e=>Promise.reject(e)),o.interceptors.response.use(e=>{let t=e.data;if((e=>!!(e&&"object"==typeof e&&"ok"in e))(t)){if(t.ok){var r;return e.data=Object.prototype.hasOwnProperty.call(t,"data")&&null!=(r=t.data)?r:null,e}let a=Error(t.message||"Request failed");return a.response={status:e.status,data:t},Promise.reject(a)}return e},e=>{var t,r,a,s,n;let l=null==(t=e.response)?void 0:t.status,o=e.code,i=((null==e?void 0:e.message)||"").toLowerCase();return 401===l?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.resolve({status:null!=l?l:0,statusText:"Unauthorized",data:null,headers:null!=(a=null==(r=e.response)?void 0:r.headers)?a:{},config:e.config,request:e.request})):403===l?(window.location.pathname.startsWith("/login")||(window.location.href="/login"),Promise.reject(e)):"ECONNABORTED"===o||i.includes("timeout")?(console.warn("API timeout – returning empty response to keep UI responsive"),Promise.resolve({status:null!=l?l:0,statusText:"Request Timeout",data:null,headers:null!=(n=null==(s=e.response)?void 0:s.headers)?n:{},config:e.config,request:e.request})):Promise.reject(e)});let i=o},57828:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("eye",[["path",{d:"M2.062 12.348a1 1 0 0 1 0-.696 10.75 10.75 0 0 1 19.876 0 1 1 0 0 1 0 .696 10.75 10.75 0 0 1-19.876 0",key:"1nclc0"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},68209:(e,t,r)=>{"use strict";r.d(t,{bC:()=>l,iD:()=>o,me:()=>c,mt:()=>i,ri:()=>d});var a=r(37621),s=r(99947);let n=["auth:user-cache","cache:auth:roles","cache:auth:perms","cache:auth:users"];function l(){try{n.forEach(e=>window.sessionStorage.removeItem(e))}catch(e){}}async function o(e){l(),await a.A.post("/auth/login",e)}async function i(){let e=[a.A.get("/registrations",{timeout:8e3}).then(e=>{let t=Array.isArray(e.data)?e.data:[];(0,s.a)("cache:auth:employees",t),(0,s.a)("cache:auth:employees:list",t),(0,s.a)("cache:auth:reports:employees",t)}).catch(()=>{}),a.A.get("/users",{timeout:8e3}).then(e=>{let t=Array.isArray(e.data)?e.data:[];(0,s.a)("cache:auth:users",t.map(e=>({id:e.id,username:e.username,fullName:e.fullName,roles:Array.isArray(e.roles)?e.roles:[],permissions:Array.isArray(e.permissions)?e.permissions:[]}))),(0,s.a)("cache:auth:users:list",t)}).catch(()=>{}),a.A.get("/roles",{timeout:8e3}).then(e=>{let t=Array.isArray(e.data)?e.data:[];(0,s.a)("cache:auth:roles",t),(0,s.a)("cache:auth:roles:list",t)}).catch(()=>{}),a.A.get("/roles/permissions",{timeout:8e3}).then(e=>{let t=Array.isArray(e.data)?e.data:[];(0,s.a)("cache:auth:perms",t)}).catch(()=>{})];await Promise.allSettled(e)}async function c(){try{let{data:e}=await a.A.get("/auth/me");return e}catch(s){var e;let t=null==s?void 0:s.code,r=((null==s?void 0:s.message)||"").toLowerCase(),a=null==s||null==(e=s.response)?void 0:e.status;if("ECONNABORTED"===t||r.includes("timeout")||r.includes("network error")||401===a||403===a)return null;throw s}}async function d(){try{await a.A.post("/auth/logout")}catch(r){var e;let t=null==r||null==(e=r.response)?void 0:e.status;if(401===t||403===t)return;throw r}finally{l()}}},70017:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>p});var a=r(95155),s=r(12115),n=r(68209),l=r(33801),o=r(20063),i=r(15239),c=r(70532),d=r(57828),u=r(17910),h=r(24947);function m(){let[e,t]=(0,s.useState)(""),[r,m]=(0,s.useState)(""),[p,g]=(0,s.useState)(!1),[x,f]=(0,s.useState)(null),[y,w]=(0,s.useState)(!1),v=(0,o.useRouter)(),b=(0,o.useSearchParams)();(0,s.useEffect)(()=>{v.prefetch("/dashboard"),v.prefetch("/maindashboard")},[v]);let A=(0,s.useCallback)(e=>{window.location.href=e},[v]),N=(0,s.useCallback)(async e=>{if(e)return void A(e);try{let e=await (0,n.me)(),t=e?(0,l.Gv)(e):null;A(t&&"/login"!==t?t:"/dashboard")}catch(e){A("/dashboard")}},[A]);(0,s.useEffect)(()=>{(async()=>{try{await (0,n.me)()&&((0,n.mt)().catch(()=>{}),N(b.get("next")))}catch(e){}})()},[b,N]);let j=async t=>{t.preventDefault(),f(null),w(!0);try{await (0,n.iD)({username:e,password:r}),(0,n.mt)().catch(()=>{}),N(b.get("next"))}catch(e){f((null==e?void 0:e.message)||"Login failed. Please check your credentials.")}finally{w(!1)}};return(0,a.jsxs)("main",{className:"relative min-h-screen flex items-center justify-center bg-gradient-to-br from-orange-50 via-white to-orange-100 p-6 overflow-hidden",children:[(0,a.jsx)("div",{className:"absolute inset-0 opacity-10 bg-[url('/spclogopic.png')] bg-center bg-no-repeat bg-contain pointer-events-none","aria-hidden":!0}),(0,a.jsxs)("div",{className:"w-full max-w-md relative",children:[(0,a.jsxs)("div",{className:"text-center mb-8",children:[(0,a.jsxs)("div",{className:"flex items-center justify-center gap-3 mb-4",children:[(0,a.jsx)("div",{className:"w-12 h-12 bg-white rounded-xl border border-orange-200 flex items-center justify-center shadow-lg overflow-hidden",children:(0,a.jsx)(i.default,{src:"/spclogopic.png",alt:"State Printing Corporation logo",width:48,height:48,className:"object-contain",priority:!0})}),(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"State Printing Corporation"})]}),(0,a.jsx)("p",{className:"text-orange-800/70 text-sm",children:"ERP System Portal"})]}),(0,a.jsxs)("form",{onSubmit:j,className:"bg-white p-8 rounded-2xl shadow-xl space-y-6 border border-orange-200",children:[(0,a.jsxs)("div",{className:"text-center",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Welcome Back"}),(0,a.jsx)("p",{className:"text-gray-600 text-sm",children:"Sign in to your account"})]}),x&&(0,a.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg text-sm",children:x}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700 mb-2",children:"Username or Email"}),(0,a.jsx)("input",{id:"username",value:e,onChange:e=>t(e.target.value),placeholder:"Enter your username or email",className:"w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all",required:!0,autoComplete:"username"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700 mb-2",children:"Password"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("input",{id:"password",type:p?"text":"password",value:r,onChange:e=>m(e.target.value),placeholder:"Enter your password",className:"w-full border border-gray-300 rounded-lg px-4 py-3 pr-10 focus:outline-none focus:ring-2 focus:ring-orange-500 focus:border-orange-500 transition-all",required:!0,autoComplete:"current-password"}),(0,a.jsx)("button",{type:"button",onClick:()=>{g(!p)},className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600 transition-colors","aria-label":p?"Hide password":"Show password",children:p?(0,a.jsx)(c.A,{size:20}):(0,a.jsx)(d.A,{size:20})})]})]})]}),(0,a.jsx)("button",{type:"submit",disabled:y,className:"w-full bg-orange-600 text-white py-3 rounded-lg hover:bg-orange-700 disabled:bg-orange-400 disabled:cursor-not-allowed transition-all duration-200 font-semibold shadow-md hover:shadow-lg flex items-center justify-center gap-2",children:y?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Signing in..."]}):"Sign In"}),(0,a.jsxs)("div",{className:"bg-orange-50 rounded-lg p-4 border border-orange-200",children:[(0,a.jsx)("h3",{className:"font-semibold text-orange-800 text-sm mb-2",children:"Available Services:"}),(0,a.jsxs)("div",{className:"space-y-2 text-xs text-orange-700",children:[(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(u.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Auth Service - User & Role Management"})]}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(h.A,{className:"w-3 h-3"}),(0,a.jsx)("span",{children:"Transport Service - Vehicle Management"})]})]})]}),(0,a.jsx)("div",{className:"text-center",children:(0,a.jsx)("p",{className:"text-xs text-gray-500",children:"Contact administrator if you forgot your credentials"})})]}),(0,a.jsx)("div",{className:"text-center mt-6",children:(0,a.jsxs)("p",{className:"text-xs text-gray-500",children:["\xa9 ",new Date().getFullYear()," SPC ERP System. All rights reserved."]})})]})]})}function p(){return(0,a.jsx)(s.Suspense,{fallback:(0,a.jsx)("div",{className:"p-6 text-center text-sm text-gray-600",children:"Loading login…"}),children:(0,a.jsx)(m,{})})}},70532:(e,t,r)=>{"use strict";r.d(t,{A:()=>a});let a=(0,r(71847).A)("eye-off",[["path",{d:"M10.733 5.076a10.744 10.744 0 0 1 11.205 6.575 1 1 0 0 1 0 .696 10.747 10.747 0 0 1-1.444 2.49",key:"ct8e1f"}],["path",{d:"M14.084 14.158a3 3 0 0 1-4.242-4.242",key:"151rxh"}],["path",{d:"M17.479 17.499a10.75 10.75 0 0 1-15.417-5.151 1 1 0 0 1 0-.696 10.75 10.75 0 0 1 4.446-5.143",key:"13bj9a"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]])},71847:(e,t,r)=>{"use strict";r.d(t,{A:()=>i});var a=r(12115);let s=e=>{let t=e.replace(/^([A-Z])|[\s-_]+(\w)/g,(e,t,r)=>r?r.toUpperCase():t.toLowerCase());return t.charAt(0).toUpperCase()+t.slice(1)},n=function(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return t.filter((e,t,r)=>!!e&&""!==e.trim()&&r.indexOf(e)===t).join(" ").trim()};var l={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};let o=(0,a.forwardRef)((e,t)=>{let{color:r="currentColor",size:s=24,strokeWidth:o=2,absoluteStrokeWidth:i,className:c="",children:d,iconNode:u,...h}=e;return(0,a.createElement)("svg",{ref:t,...l,width:s,height:s,stroke:r,strokeWidth:i?24*Number(o)/Number(s):o,className:n("lucide",c),...!d&&!(e=>{for(let t in e)if(t.startsWith("aria-")||"role"===t||"title"===t)return!0})(h)&&{"aria-hidden":"true"},...h},[...u.map(e=>{let[t,r]=e;return(0,a.createElement)(t,r)}),...Array.isArray(d)?d:[d]])}),i=(e,t)=>{let r=(0,a.forwardRef)((r,l)=>{let{className:i,...c}=r;return(0,a.createElement)(o,{ref:l,iconNode:t,className:n("lucide-".concat(s(e).replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase()),"lucide-".concat(e),i),...c})});return r.displayName=s(e),r}},99947:(e,t,r)=>{"use strict";function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:3e5;try{let r=window.sessionStorage.getItem(e);if(!r)return null;let a=JSON.parse(r);if(!(null==a?void 0:a.data)||!(null==a?void 0:a.ts))return null;if(Date.now()-a.ts>t)return window.sessionStorage.removeItem(e),null;return a.data}catch(e){return null}}function s(e,t){try{if(null===t)return void window.sessionStorage.removeItem(e);let r={data:t,ts:Date.now()};window.sessionStorage.setItem(e,JSON.stringify(r))}catch(e){}}r.d(t,{a:()=>s,x:()=>a})}},e=>{e.O(0,[5125,6394,8441,1255,7358],()=>e(e.s=12219)),_N_E=e.O()}]);